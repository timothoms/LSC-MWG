<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Classifications</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">LSC-MWG</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Introduction</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="classifications.html">Classifications</a>
</li>
<li>
  <a href="panel.html">Panel Models</a>
</li>
<li>
  <a href="sequences.html">Sequences</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/timothoms/LSC-MWG/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Classifications</h1>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>IsTrue <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="sc">!</span><span class="fu">is.na</span>(x) <span class="sc">&amp;</span> x }</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;_data/LSCMWG_working_data.RData&quot;</span>)</span></code></pre></div>
<div id="section"
class="section level3 tabset tabset-fade tabset-pills">
<h3 class="tabset tabset-fade tabset-pills"></h3>
<div id="classification-with-two-variables-on-each-dimensions-for-1990"
class="section level4">
<h4>Classification with two variables on each dimensions for 1990</h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>Classification <span class="ot">&lt;-</span> <span class="cf">function</span>(health, gender, </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="at">df =</span> data, </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">year_to_show =</span> <span class="dv">1995</span>, </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">min_to_include =</span> <span class="dv">2</span> <span class="co"># this is not implemented well but works for the current setup</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>){</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;q&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  vars <span class="ot">=</span> <span class="fu">c</span>(health, gender)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;period&quot;</span>, vars)]</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="do">## creating 5-year averages</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    <span class="fu">group_by</span>(country, period) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(vars), <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">&quot;{col}_avg&quot;</span>), <span class="at">.keep =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">1970</span>, <span class="dv">2015</span>, <span class="dv">5</span>)) <span class="sc">%&gt;%</span>    <span class="co"># I removed 2018 here, for consistent panels, with downstream implications</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>    <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">paste</span>(vars, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>], <span class="at">.names =</span> <span class="st">&quot;{col}_q20&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">paste</span>(vars, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">3</span>], <span class="at">.names =</span> <span class="st">&quot;{col}_q40&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">paste</span>(vars, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>], <span class="at">.names =</span> <span class="st">&quot;{col}_q60&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">paste</span>(vars, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>], <span class="at">.names =</span> <span class="st">&quot;{col}_q80&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  df[, <span class="fu">paste</span>(vars, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(vars, <span class="cf">function</span>(var) {</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    col <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(df))</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>    col[df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&lt;</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q20&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    col[df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&gt;=</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q20&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&amp;</span> </span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>      df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&lt;</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q40&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>    col[df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&gt;=</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q40&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&amp;</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>      df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&lt;</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q60&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>    col[df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&gt;=</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q60&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&amp;</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>      df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&lt;</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q80&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>    col[df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">&gt;=</span> df[, <span class="fu">paste</span>(var, <span class="st">&quot;avg_q80&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>    <span class="fu">return</span>(col)</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>  })</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co"># df &lt;- df[, c(&quot;country&quot;, &quot;year&quot;, &quot;period&quot;, names(df)[str_detect(names(df), fixed(&quot;quintile&quot;))])]</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>  <span class="co"># combis &lt;- expand.grid(health = health, gender = gender, stringsAsFactors = FALSE)</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>  <span class="co"># combis &lt;- split(combis, seq(nrow(combis)))</span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>  df<span class="sc">$</span>health_q1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(health, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>  df<span class="sc">$</span>health_q2 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(health, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>  df<span class="sc">$</span>health_q3 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(health, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">3</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>  df<span class="sc">$</span>health_q4 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(health, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>  df<span class="sc">$</span>health_q5 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(health, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>  df<span class="sc">$</span>gender_q1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(gender, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>  df<span class="sc">$</span>gender_q2 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(gender, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>  df<span class="sc">$</span>gender_q3 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(gender, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">3</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a>  df<span class="sc">$</span>gender_q4 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(gender, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a>  df<span class="sc">$</span>gender_q5 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, <span class="fu">paste</span>(gender, <span class="st">&quot;quintile&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="sc">==</span> <span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a>  health_vars <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;health&quot;</span>, qs, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a>  gender_vars <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;gender&quot;</span>, qs, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a>  df<span class="sc">$</span>health_valid <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, health_vars])</span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a>  df<span class="sc">$</span>gender_valid <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(df[, gender_vars])</span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a>  df<span class="sc">$</span>valid <span class="ot">&lt;-</span> df<span class="sc">$</span>health_valid <span class="sc">*</span> df<span class="sc">$</span>gender_valid</span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a>  <span class="co"># unique(df$country[df$valid  == 0])</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>valid <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a>  <span class="do">### version based on the standardized vars</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a>  new <span class="ot">&lt;-</span> df[, <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="fu">paste</span>(vars, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))] <span class="sc">%&gt;%</span></span>
<span id="cb2-54"><a href="#cb2-54" tabindex="-1"></a>    <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb2-55"><a href="#cb2-55" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">paste</span>(vars, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="sc">~</span><span class="fu">as.numeric</span>(<span class="fu">scale</span>(.x)), <span class="at">.names =</span> <span class="st">&quot;{col}&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-56"><a href="#cb2-56" tabindex="-1"></a>    <span class="co"># mutate(health = (imr_wpp_avg + life_exp_wpp_avg)/2, </span></span>
<span id="cb2-57"><a href="#cb2-57" tabindex="-1"></a>    <span class="co">#        gender = (asfr_adol_wpp_avg + mys_age_ratio_ihme_avg)/2) %&gt;% </span></span>
<span id="cb2-58"><a href="#cb2-58" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">health =</span> (.data[[<span class="fu">paste</span>(health[<span class="dv">1</span>], <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]] <span class="sc">+</span> .data[[<span class="fu">paste</span>(health[<span class="dv">2</span>], <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]])<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb2-59"><a href="#cb2-59" tabindex="-1"></a>           <span class="at">gender =</span> (.data[[<span class="fu">paste</span>(gender[<span class="dv">1</span>], <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]] <span class="sc">+</span> .data[[<span class="fu">paste</span>(gender[<span class="dv">2</span>], <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)]])<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-60"><a href="#cb2-60" tabindex="-1"></a>    <span class="fu">select</span>(country, year, health, gender) <span class="sc">%&gt;%</span> </span>
<span id="cb2-61"><a href="#cb2-61" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb2-62"><a href="#cb2-62" tabindex="-1"></a>  new<span class="sc">$</span>health_class[new<span class="sc">$</span>health <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>health, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-63"><a href="#cb2-63" tabindex="-1"></a>  new<span class="sc">$</span>health_class[new<span class="sc">$</span>health <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>health, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-64"><a href="#cb2-64" tabindex="-1"></a>  new<span class="sc">$</span>health_class[new<span class="sc">$</span>health <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>health, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-65"><a href="#cb2-65" tabindex="-1"></a>  new<span class="sc">$</span>health_class[new<span class="sc">$</span>health <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>health, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>]] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb2-66"><a href="#cb2-66" tabindex="-1"></a>  new<span class="sc">$</span>health_class[new<span class="sc">$</span>health <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>health, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb2-67"><a href="#cb2-67" tabindex="-1"></a>  new<span class="sc">$</span>gender_class[new<span class="sc">$</span>gender <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>gender, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-68"><a href="#cb2-68" tabindex="-1"></a>  new<span class="sc">$</span>gender_class[new<span class="sc">$</span>gender <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>gender, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-69"><a href="#cb2-69" tabindex="-1"></a>  new<span class="sc">$</span>gender_class[new<span class="sc">$</span>gender <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>gender, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-70"><a href="#cb2-70" tabindex="-1"></a>  new<span class="sc">$</span>gender_class[new<span class="sc">$</span>gender <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>gender, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>]] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb2-71"><a href="#cb2-71" tabindex="-1"></a>  new<span class="sc">$</span>gender_class[new<span class="sc">$</span>gender <span class="sc">&gt;=</span> <span class="fu">quantile</span>(new<span class="sc">$</span>gender, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb2-72"><a href="#cb2-72" tabindex="-1"></a>  new<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;H&quot;</span>, new<span class="sc">$</span>health_class, <span class="st">&quot;G&quot;</span>, new<span class="sc">$</span>gender_class, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-73"><a href="#cb2-73" tabindex="-1"></a>  tab_st <span class="ot">&lt;-</span> new <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> year_to_show)</span>
<span id="cb2-74"><a href="#cb2-74" tabindex="-1"></a>  n_st <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">health =</span> tab_st<span class="sc">$</span>health_class, <span class="at">gender =</span> tab_st<span class="sc">$</span>gender_class)</span>
<span id="cb2-75"><a href="#cb2-75" tabindex="-1"></a>  <span class="fu">dimnames</span>(n_st) <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">dimnames</span>(n_st), <span class="cf">function</span>(name) { <span class="fu">paste</span>(<span class="st">&quot;Q&quot;</span>, name, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) })</span>
<span id="cb2-76"><a href="#cb2-76" tabindex="-1"></a>  tab_st <span class="ot">&lt;-</span> <span class="fu">tapply</span>(tab_st<span class="sc">$</span>country, <span class="fu">list</span>(<span class="at">health =</span> tab_st<span class="sc">$</span>health_class, <span class="at">gender =</span> tab_st<span class="sc">$</span>gender_class), paste, <span class="at">collapse =</span> <span class="st">&quot;; &quot;</span>)</span>
<span id="cb2-77"><a href="#cb2-77" tabindex="-1"></a>  tab_st[<span class="fu">is.na</span>(tab_st)] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb2-78"><a href="#cb2-78" tabindex="-1"></a>  <span class="fu">dimnames</span>(tab_st) <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">dimnames</span>(tab_st), <span class="cf">function</span>(name) { <span class="fu">paste</span>(<span class="st">&quot;Q&quot;</span>, name, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) })</span>
<span id="cb2-79"><a href="#cb2-79" tabindex="-1"></a>  <span class="do">### back to original version</span></span>
<span id="cb2-80"><a href="#cb2-80" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[, <span class="sc">!</span><span class="fu">names</span>(df) <span class="sc">%in%</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">c</span>(<span class="st">&quot;q20&quot;</span>, <span class="st">&quot;q40&quot;</span>, <span class="st">&quot;q60&quot;</span>, <span class="st">&quot;q80&quot;</span>, <span class="st">&quot;quintile&quot;</span>, health, gender), <span class="cf">function</span>(x) <span class="fu">names</span>(df)[<span class="fu">str_detect</span>(<span class="fu">names</span>(df), x)]))]</span>
<span id="cb2-81"><a href="#cb2-81" tabindex="-1"></a>  health_true <span class="ot">&lt;-</span> df[, health_vars] <span class="sc">==</span> <span class="fu">apply</span>(df[, health_vars], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> max)</span>
<span id="cb2-82"><a href="#cb2-82" tabindex="-1"></a>  gender_true <span class="ot">&lt;-</span> df[, gender_vars] <span class="sc">==</span> <span class="fu">apply</span>(df[, gender_vars], <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> max)</span>
<span id="cb2-83"><a href="#cb2-83" tabindex="-1"></a>  health_help <span class="ot">&lt;-</span> health_true <span class="sc">*</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(health_true), <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-84"><a href="#cb2-84" tabindex="-1"></a>  gender_help <span class="ot">&lt;-</span> gender_true <span class="sc">*</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(gender_true), <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-85"><a href="#cb2-85" tabindex="-1"></a>  help_floor <span class="ot">&lt;-</span> <span class="cf">function</span>(set) { <span class="fu">return</span>(<span class="fu">floor</span>(<span class="fu">mean</span>(set[set <span class="sc">!=</span> <span class="dv">0</span>]))) }</span>
<span id="cb2-86"><a href="#cb2-86" tabindex="-1"></a>  help_ceiling <span class="ot">&lt;-</span> <span class="cf">function</span>(set) { <span class="fu">return</span>(<span class="fu">ceiling</span>(<span class="fu">mean</span>(set[set <span class="sc">!=</span> <span class="dv">0</span>]))) }</span>
<span id="cb2-87"><a href="#cb2-87" tabindex="-1"></a>  df<span class="sc">$</span>health_class <span class="ot">&lt;-</span> <span class="fu">apply</span>(health_help, <span class="at">MARGIN =</span> <span class="dv">1</span>, help_floor)</span>
<span id="cb2-88"><a href="#cb2-88" tabindex="-1"></a>  df<span class="sc">$</span>gender_class <span class="ot">&lt;-</span> <span class="fu">apply</span>(gender_help, <span class="at">MARGIN =</span> <span class="dv">1</span>, help_floor)</span>
<span id="cb2-89"><a href="#cb2-89" tabindex="-1"></a>  df<span class="sc">$</span>health_class_alt <span class="ot">&lt;-</span> <span class="fu">apply</span>(health_help, <span class="at">MARGIN =</span> <span class="dv">1</span>, help_ceiling)</span>
<span id="cb2-90"><a href="#cb2-90" tabindex="-1"></a>  df<span class="sc">$</span>gender_class_alt <span class="ot">&lt;-</span> <span class="fu">apply</span>(gender_help, <span class="at">MARGIN =</span> <span class="dv">1</span>, help_ceiling)</span>
<span id="cb2-91"><a href="#cb2-91" tabindex="-1"></a>  df<span class="sc">$</span>health_flag <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>health_class <span class="sc">!=</span> df<span class="sc">$</span>health_class_alt, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-92"><a href="#cb2-92" tabindex="-1"></a>  df<span class="sc">$</span>gender_flag <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>gender_class <span class="sc">!=</span> df<span class="sc">$</span>gender_class_alt, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-93"><a href="#cb2-93" tabindex="-1"></a>  health_index <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;health_q&quot;</span>, df<span class="sc">$</span>health_class, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-94"><a href="#cb2-94" tabindex="-1"></a>  gender_index <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;gender_q&quot;</span>, df<span class="sc">$</span>gender_class, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-95"><a href="#cb2-95" tabindex="-1"></a>  df<span class="sc">$</span>health_n <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(health_index), <span class="cf">function</span>(index) { </span>
<span id="cb2-96"><a href="#cb2-96" tabindex="-1"></a>    <span class="fu">as.integer</span>(df[index, health_index[index]]) </span>
<span id="cb2-97"><a href="#cb2-97" tabindex="-1"></a>  }))</span>
<span id="cb2-98"><a href="#cb2-98" tabindex="-1"></a>  df<span class="sc">$</span>gender_n <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gender_index), <span class="cf">function</span>(index) { </span>
<span id="cb2-99"><a href="#cb2-99" tabindex="-1"></a>    <span class="fu">as.integer</span>(df[index, gender_index[index]]) </span>
<span id="cb2-100"><a href="#cb2-100" tabindex="-1"></a>  }))</span>
<span id="cb2-101"><a href="#cb2-101" tabindex="-1"></a>  df<span class="sc">$</span>combi <span class="ot">&lt;-</span> df<span class="sc">$</span>health_n <span class="sc">*</span> df<span class="sc">$</span>gender_n</span>
<span id="cb2-102"><a href="#cb2-102" tabindex="-1"></a>  df<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;H&quot;</span>, df<span class="sc">$</span>health_class, <span class="st">&quot;G&quot;</span>, df<span class="sc">$</span>gender_class, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-103"><a href="#cb2-103" tabindex="-1"></a>  df<span class="sc">$</span>class_alt <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;H&quot;</span>, df<span class="sc">$</span>health_class_alt, <span class="st">&quot;G&quot;</span>, df<span class="sc">$</span>gender_class_alt, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-104"><a href="#cb2-104" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">table</span>(df[df<span class="sc">$</span>year <span class="sc">==</span> year_to_show <span class="sc">&amp;</span> df<span class="sc">$</span>valid <span class="sc">&gt;=</span> min_to_include, <span class="fu">c</span>(<span class="st">&quot;health_class&quot;</span>, <span class="st">&quot;gender_class&quot;</span>)])</span>
<span id="cb2-105"><a href="#cb2-105" tabindex="-1"></a>  <span class="co"># print(test)</span></span>
<span id="cb2-106"><a href="#cb2-106" tabindex="-1"></a>  <span class="co"># sum(test)</span></span>
<span id="cb2-107"><a href="#cb2-107" tabindex="-1"></a>  df<span class="sc">$</span>support <span class="ot">&lt;-</span> <span class="fu">paste</span>(df<span class="sc">$</span>country, <span class="st">&quot; (&quot;</span>, df<span class="sc">$</span>combi, <span class="st">&quot;/&quot;</span>, df<span class="sc">$</span>valid, <span class="st">&quot;)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-108"><a href="#cb2-108" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> df[df<span class="sc">$</span>year <span class="sc">==</span> year_to_show, ]</span>
<span id="cb2-109"><a href="#cb2-109" tabindex="-1"></a>  table_to_return <span class="ot">&lt;-</span> <span class="fu">tapply</span>(dat<span class="sc">$</span>support, </span>
<span id="cb2-110"><a href="#cb2-110" tabindex="-1"></a>                            <span class="at">INDEX =</span> <span class="fu">list</span>(<span class="at">health =</span> dat<span class="sc">$</span>health_class, <span class="at">gender =</span> dat<span class="sc">$</span>gender_class), </span>
<span id="cb2-111"><a href="#cb2-111" tabindex="-1"></a>                            paste, <span class="at">collapse =</span> <span class="st">&quot;; &quot;</span>)</span>
<span id="cb2-112"><a href="#cb2-112" tabindex="-1"></a>  table_to_return[<span class="fu">is.na</span>(table_to_return)] <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb2-113"><a href="#cb2-113" tabindex="-1"></a>  <span class="fu">dimnames</span>(table_to_return) <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">dimnames</span>(table_to_return), <span class="cf">function</span>(name) { <span class="fu">paste</span>(<span class="st">&quot;Q&quot;</span>, name, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>) })</span>
<span id="cb2-114"><a href="#cb2-114" tabindex="-1"></a>  <span class="do">## from here, this is the old way, to create the fuzzy table, not needed anymore but useful for comparison</span></span>
<span id="cb2-115"><a href="#cb2-115" tabindex="-1"></a>  df<span class="sc">$</span>H1G1 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q1 <span class="sc">*</span> df<span class="sc">$</span>gender_q1</span>
<span id="cb2-116"><a href="#cb2-116" tabindex="-1"></a>  df<span class="sc">$</span>H2G1 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q2 <span class="sc">*</span> df<span class="sc">$</span>gender_q1</span>
<span id="cb2-117"><a href="#cb2-117" tabindex="-1"></a>  df<span class="sc">$</span>H3G1 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q3 <span class="sc">*</span> df<span class="sc">$</span>gender_q1</span>
<span id="cb2-118"><a href="#cb2-118" tabindex="-1"></a>  df<span class="sc">$</span>H4G1 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q4 <span class="sc">*</span> df<span class="sc">$</span>gender_q1</span>
<span id="cb2-119"><a href="#cb2-119" tabindex="-1"></a>  df<span class="sc">$</span>H5G1 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q5 <span class="sc">*</span> df<span class="sc">$</span>gender_q1</span>
<span id="cb2-120"><a href="#cb2-120" tabindex="-1"></a>  df<span class="sc">$</span>H1G2 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q1 <span class="sc">*</span> df<span class="sc">$</span>gender_q2</span>
<span id="cb2-121"><a href="#cb2-121" tabindex="-1"></a>  df<span class="sc">$</span>H2G2 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q2 <span class="sc">*</span> df<span class="sc">$</span>gender_q2</span>
<span id="cb2-122"><a href="#cb2-122" tabindex="-1"></a>  df<span class="sc">$</span>H3G2 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q3 <span class="sc">*</span> df<span class="sc">$</span>gender_q2</span>
<span id="cb2-123"><a href="#cb2-123" tabindex="-1"></a>  df<span class="sc">$</span>H4G2 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q4 <span class="sc">*</span> df<span class="sc">$</span>gender_q2</span>
<span id="cb2-124"><a href="#cb2-124" tabindex="-1"></a>  df<span class="sc">$</span>H5G2 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q5 <span class="sc">*</span> df<span class="sc">$</span>gender_q2</span>
<span id="cb2-125"><a href="#cb2-125" tabindex="-1"></a>  df<span class="sc">$</span>H1G3 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q1 <span class="sc">*</span> df<span class="sc">$</span>gender_q3</span>
<span id="cb2-126"><a href="#cb2-126" tabindex="-1"></a>  df<span class="sc">$</span>H2G3 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q2 <span class="sc">*</span> df<span class="sc">$</span>gender_q3</span>
<span id="cb2-127"><a href="#cb2-127" tabindex="-1"></a>  df<span class="sc">$</span>H3G3 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q3 <span class="sc">*</span> df<span class="sc">$</span>gender_q3</span>
<span id="cb2-128"><a href="#cb2-128" tabindex="-1"></a>  df<span class="sc">$</span>H4G3 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q4 <span class="sc">*</span> df<span class="sc">$</span>gender_q3</span>
<span id="cb2-129"><a href="#cb2-129" tabindex="-1"></a>  df<span class="sc">$</span>H5G3 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q5 <span class="sc">*</span> df<span class="sc">$</span>gender_q3</span>
<span id="cb2-130"><a href="#cb2-130" tabindex="-1"></a>  df<span class="sc">$</span>H1G4 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q1 <span class="sc">*</span> df<span class="sc">$</span>gender_q4</span>
<span id="cb2-131"><a href="#cb2-131" tabindex="-1"></a>  df<span class="sc">$</span>H2G4 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q2 <span class="sc">*</span> df<span class="sc">$</span>gender_q4</span>
<span id="cb2-132"><a href="#cb2-132" tabindex="-1"></a>  df<span class="sc">$</span>H3G4 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q3 <span class="sc">*</span> df<span class="sc">$</span>gender_q4</span>
<span id="cb2-133"><a href="#cb2-133" tabindex="-1"></a>  df<span class="sc">$</span>H4G4 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q4 <span class="sc">*</span> df<span class="sc">$</span>gender_q4</span>
<span id="cb2-134"><a href="#cb2-134" tabindex="-1"></a>  df<span class="sc">$</span>H5G4 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q5 <span class="sc">*</span> df<span class="sc">$</span>gender_q4</span>
<span id="cb2-135"><a href="#cb2-135" tabindex="-1"></a>  df<span class="sc">$</span>H1G5 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q1 <span class="sc">*</span> df<span class="sc">$</span>gender_q5</span>
<span id="cb2-136"><a href="#cb2-136" tabindex="-1"></a>  df<span class="sc">$</span>H2G5 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q2 <span class="sc">*</span> df<span class="sc">$</span>gender_q5</span>
<span id="cb2-137"><a href="#cb2-137" tabindex="-1"></a>  df<span class="sc">$</span>H3G5 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q3 <span class="sc">*</span> df<span class="sc">$</span>gender_q5</span>
<span id="cb2-138"><a href="#cb2-138" tabindex="-1"></a>  df<span class="sc">$</span>H4G5 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q4 <span class="sc">*</span> df<span class="sc">$</span>gender_q5</span>
<span id="cb2-139"><a href="#cb2-139" tabindex="-1"></a>  df<span class="sc">$</span>H5G5 <span class="ot">&lt;-</span> df<span class="sc">$</span>health_q5 <span class="sc">*</span> df<span class="sc">$</span>gender_q5</span>
<span id="cb2-140"><a href="#cb2-140" tabindex="-1"></a>  vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H1G1&quot;</span>, <span class="st">&quot;H2G1&quot;</span>, <span class="st">&quot;H3G1&quot;</span>, <span class="st">&quot;H4G1&quot;</span>, <span class="st">&quot;H5G1&quot;</span>, </span>
<span id="cb2-141"><a href="#cb2-141" tabindex="-1"></a>            <span class="st">&quot;H1G2&quot;</span>, <span class="st">&quot;H2G2&quot;</span>, <span class="st">&quot;H3G2&quot;</span>, <span class="st">&quot;H4G2&quot;</span>, <span class="st">&quot;H5G2&quot;</span>, </span>
<span id="cb2-142"><a href="#cb2-142" tabindex="-1"></a>            <span class="st">&quot;H1G3&quot;</span>, <span class="st">&quot;H2G3&quot;</span>, <span class="st">&quot;H3G3&quot;</span>, <span class="st">&quot;H4G3&quot;</span>, <span class="st">&quot;H5G3&quot;</span>, </span>
<span id="cb2-143"><a href="#cb2-143" tabindex="-1"></a>            <span class="st">&quot;H1G4&quot;</span>, <span class="st">&quot;H2G4&quot;</span>, <span class="st">&quot;H3G4&quot;</span>, <span class="st">&quot;H4G4&quot;</span>, <span class="st">&quot;H5G4&quot;</span>, </span>
<span id="cb2-144"><a href="#cb2-144" tabindex="-1"></a>            <span class="st">&quot;H1G5&quot;</span>, <span class="st">&quot;H2G5&quot;</span>, <span class="st">&quot;H3G5&quot;</span>, <span class="st">&quot;H4G5&quot;</span>, <span class="st">&quot;H5G5&quot;</span>)</span>
<span id="cb2-145"><a href="#cb2-145" tabindex="-1"></a>  <span class="fu">names</span>(vars) <span class="ot">&lt;-</span> vars</span>
<span id="cb2-146"><a href="#cb2-146" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df[df<span class="sc">$</span>year <span class="sc">==</span> year_to_show, <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;valid&quot;</span>, vars)])</span>
<span id="cb2-147"><a href="#cb2-147" tabindex="-1"></a>  classifications <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">mclapply</span>(vars, <span class="cf">function</span>(var_name) {</span>
<span id="cb2-148"><a href="#cb2-148" tabindex="-1"></a>    new <span class="ot">&lt;-</span> dat[dat[, var_name] <span class="sc">&gt;=</span> min_to_include, <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, var_name, <span class="st">&quot;valid&quot;</span>)]</span>
<span id="cb2-149"><a href="#cb2-149" tabindex="-1"></a>    countries <span class="ot">&lt;-</span> new<span class="sc">$</span>country</span>
<span id="cb2-150"><a href="#cb2-150" tabindex="-1"></a>    new <span class="ot">&lt;-</span> <span class="fu">paste</span>(new[, <span class="st">&quot;country&quot;</span>], <span class="st">&quot; (&quot;</span>, new[, var_name], <span class="st">&quot;/&quot;</span>, new[, <span class="st">&quot;valid&quot;</span>], <span class="st">&quot;)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-151"><a href="#cb2-151" tabindex="-1"></a>    new <span class="ot">&lt;-</span> new[new <span class="sc">!=</span> <span class="st">&quot; (/)&quot;</span>]    </span>
<span id="cb2-152"><a href="#cb2-152" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">class =</span> new, <span class="at">ctry =</span> countries))</span>
<span id="cb2-153"><a href="#cb2-153" tabindex="-1"></a>  })</span>
<span id="cb2-154"><a href="#cb2-154" tabindex="-1"></a>  countries <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(classifications, <span class="cf">function</span>(x) { x<span class="sc">$</span>ctry }))))</span>
<span id="cb2-155"><a href="#cb2-155" tabindex="-1"></a>  classifications <span class="ot">&lt;-</span> <span class="fu">lapply</span>(classifications, <span class="cf">function</span>(class) { class<span class="sc">$</span>class })</span>
<span id="cb2-156"><a href="#cb2-156" tabindex="-1"></a>  classifications <span class="ot">&lt;-</span> <span class="fu">lapply</span>(classifications, paste, <span class="at">collapse =</span> <span class="st">&quot;; &quot;</span>)</span>
<span id="cb2-157"><a href="#cb2-157" tabindex="-1"></a>  <span class="co"># print(matrix(names(classifications), 5, 5, dimnames = list(health = qs, gender = qs)))</span></span>
<span id="cb2-158"><a href="#cb2-158" tabindex="-1"></a>  fuzzy_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(classifications, <span class="dv">5</span>, <span class="dv">5</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">health =</span> qs, <span class="at">gender =</span> qs))</span>
<span id="cb2-159"><a href="#cb2-159" tabindex="-1"></a>  <span class="co"># if(number_of_countries != length(countries)) {</span></span>
<span id="cb2-160"><a href="#cb2-160" tabindex="-1"></a>  <span class="co">#   cat(&quot;\nNot classifying the same number of countries as the fuzzy way!&quot;)</span></span>
<span id="cb2-161"><a href="#cb2-161" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb2-162"><a href="#cb2-162" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df[, <span class="sc">!</span><span class="fu">names</span>(df) <span class="sc">%in%</span> vars]</span>
<span id="cb2-163"><a href="#cb2-163" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">df =</span> df, <span class="at">n =</span> test, <span class="at">table =</span> table_to_return, <span class="at">fuzzy =</span> fuzzy_table, <span class="at">standardized =</span> new, <span class="at">table_st =</span> tab_st, <span class="at">n_st =</span> n_st))  </span>
<span id="cb2-164"><a href="#cb2-164" tabindex="-1"></a>}</span>
<span id="cb2-165"><a href="#cb2-165" tabindex="-1"></a><span class="co"># variables$gender &lt;- c(&quot;asfr_adol_wpp&quot;, &quot;mys_ratio_hdr&quot;)</span></span>
<span id="cb2-166"><a href="#cb2-166" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">Classification</span>(<span class="at">health =</span> variables<span class="sc">$</span>health, <span class="at">gender =</span> variables<span class="sc">$</span>gender, <span class="at">year_to_show =</span> <span class="dv">1995</span>)</span>
<span id="cb2-167"><a href="#cb2-167" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable</span>(result<span class="sc">$</span>table, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-168"><a href="#cb2-168" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-169"><a href="#cb2-169" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;Gender&quot;</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-170"><a href="#cb2-170" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">group_rows</span>(<span class="st">&quot;Health&quot;</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Gender
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Q1
</th>
<th style="text-align:left;">
Q2
</th>
<th style="text-align:left;">
Q3
</th>
<th style="text-align:left;">
Q4
</th>
<th style="text-align:left;">
Q5
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="6" style="border-bottom: 1px solid;">
<strong>Health</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q1
</td>
<td style="text-align:left;">
Afghanistan (4/4); Angola (4/4); Bangladesh (2/4); Benin (4/4); Bhutan
(1/4); Burkina Faso (4/4); Burundi (2/4); Cameroon (2/4); Central
African Republic (4/4); Chad (4/4); Congo (1/4); Congo, DRC (4/4); Cote
d’Ivoire (4/4); Equatorial Guinea (4/4); Eritrea (2/4); Ethiopia (2/4);
Gambia (2/4); Guinea (4/4); Guinea-Bissau (4/4); Liberia (4/4);
Madagascar (2/4); Malawi (4/4); Mali (4/4); Mozambique (2/4); Nepal
(2/4); Niger (4/4); Nigeria (2/4); Sierra Leone (4/4); Somalia (2/4);
Tanzania (2/4); Uganda (4/4); Yemen (2/4); Zambia (2/4)
</td>
<td style="text-align:left;">
Cambodia (2/4); Haiti (2/4); Kenya (2/4); Laos (4/4); Pakistan (0/4);
Rwanda (2/4); Zimbabwe (2/4)
</td>
<td style="text-align:left;">
Tajikistan (2/4)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q2
</td>
<td style="text-align:left;">
Comoros (2/4); Guatemala (2/4); India (2/4); Mauritania (2/4); Sao Tome
&amp; Principe (2/4); Senegal (4/4); Sudan (2/4); Togo (2/4)
</td>
<td style="text-align:left;">
Bolivia (4/4); Djibouti (0/4); Egypt (2/4); Eswatini (0/4); Gabon (0/4);
Ghana (4/4); Indonesia (2/4); Maldives (2/4); Morocco (0/4); Namibia
(2/4); Papua New Guinea (2/4); Solomon Islands (2/4); Turkey (1/4)
</td>
<td style="text-align:left;">
Azerbaijan (2/4); Botswana (0/4); Dominican Republic (0/4); Guyana
(0/4); Kiribati (2/4); Kyrgyzstan (1/4); Lesotho (0/4); Micronesia
(1/4); Myanmar (2/4); Peru (2/4); South Africa (0/4); Turkmenistan
(2/4); Uzbekistan (2/4)
</td>
<td style="text-align:left;">
Kazakhstan (4/4); Mongolia (4/4)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q3
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Belize (0/4); Cape Verde (4/4); El Salvador (2/4); Honduras (0/4); Iran
(2/4); Iraq (2/4); Nicaragua (0/4); Oman (2/4); Palestinian Territory
(4/4); Saudi Arabia (0/4); Suriname (2/4)
</td>
<td style="text-align:left;">
Algeria (0/4); Armenia (2/4); China (0/4); Colombia (0/4); Ecuador
(0/4); Fiji (0/4); Jordan (0/4); Libya (0/4); Macedonia (1/4); Mexico
(2/4); North Korea (0/4); Paraguay (0/4); Romania (1/4); Trinidad &amp;
Tobago (2/4); Tunisia (0/4); Vanuatu (4/4); Viet Nam (0/4)
</td>
<td style="text-align:left;">
Albania (0/4); Belarus (1/4); Brazil (0/4); Estonia (1/4); Georgia
(0/4); Hungary (2/4); Latvia (1/4); Lithuania (1/4); Moldova (0/4);
Philippines (2/4); Russian Federation (1/4); Samoa (1/4); Tonga (1/4);
Ukraine (0/4)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q4
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Syria (2/4)
</td>
<td style="text-align:left;">
Bahrain (0/4); Barbados (1/4); Bosnia &amp; Herzegovina (2/4); Brunei
(1/4); Costa Rica (0/4); Grenada (2/4); Jamaica (0/4); Lebanon (2/4);
Malaysia (0/4); Mauritius (2/4); Panama (0/4); Saint Lucia (0/4); Saint
Vincent &amp; the Grenadines (0/4); Seychelles (2/4); Slovakia (1/4);
Sri Lanka (2/4); Thailand (2/4); United Arab Emirates (0/4); Venezuela
(0/4)
</td>
<td style="text-align:left;">
Antigua &amp; Barbuda (0/4); Argentina (0/4); Bahamas (0/4); Bulgaria
(0/4); Chile (0/4); Croatia (0/4); Czech Republic (2/4); Kuwait (0/4);
Poland (2/4); Qatar (2/4); South Korea (0/4); Uruguay (0/4)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q5
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Cuba (2/4)
</td>
<td style="text-align:left;">
Austria (0/4); Cyprus (0/4); Germany (2/4); Greece (0/4); Iceland (4/4);
Israel (2/4); Italy (2/4); Japan (2/4); Luxembourg (2/4); Malta (2/4);
Netherlands (2/4); New Zealand (2/4); Portugal (2/4); Singapore (0/4);
Slovenia (2/4); Spain (2/4); Switzerland (0/4); Taiwan (0/4); United
Kingdom (2/4); United States of America (0/4)
</td>
<td style="text-align:left;">
Australia (4/4); Belgium (4/4); Canada (4/4); Denmark (4/4); Finland
(4/4); France (4/4); Ireland (4/4); Norway (4/4); Sweden (4/4)
</td>
</tr>
</tbody>
</table>
</div>
<div id="fuzzy-version-of-classification" class="section level4">
<h4>Fuzzy version of classification</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable</span>(result<span class="sc">$</span>fuzzy, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;Gender&quot;</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">group_rows</span>(<span class="st">&quot;Health&quot;</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Gender
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
q1
</th>
<th style="text-align:left;">
q2
</th>
<th style="text-align:left;">
q3
</th>
<th style="text-align:left;">
q4
</th>
<th style="text-align:left;">
q5
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="6" style="border-bottom: 1px solid;">
<strong>Health</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
q1
</td>
<td style="text-align:left;">
Afghanistan (4/4); Angola (4/4); Bangladesh (2/4); Benin (4/4); Burkina
Faso (4/4); Burundi (2/4); Cameroon (2/4); Central African Republic
(4/4); Chad (4/4); Congo, DRC (4/4); Cote d’Ivoire (4/4); Equatorial
Guinea (4/4); Eritrea (2/4); Ethiopia (2/4); Gambia (2/4); Guinea (4/4);
Guinea-Bissau (4/4); Liberia (4/4); Madagascar (2/4); Malawi (4/4); Mali
(4/4); Mozambique (2/4); Nepal (2/4); Niger (4/4); Nigeria (2/4); Sierra
Leone (4/4); Somalia (2/4); Tanzania (2/4); Uganda (4/4); Yemen (2/4);
Zambia (2/4)
</td>
<td style="text-align:left;">
Burundi (2/4); Cambodia (2/4); Cameroon (2/4); Eritrea (2/4); Ethiopia
(2/4); Haiti (2/4); Kenya (2/4); Laos (4/4); Madagascar (2/4);
Mozambique (2/4); Nigeria (2/4); Rwanda (2/4); Somalia (2/4); Tanzania
(2/4); Zambia (2/4); Zimbabwe (2/4)
</td>
<td style="text-align:left;">
Cambodia (2/4); Haiti (2/4); Rwanda (2/4); Tajikistan (2/4)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
q2
</td>
<td style="text-align:left;">
Bangladesh (2/4); Comoros (2/4); Djibouti (2/4); Eswatini (2/4); Gabon
(2/4); Gambia (2/4); Guatemala (2/4); India (2/4); Mauritania (2/4);
Nepal (2/4); Sao Tome &amp; Principe (2/4); Senegal (4/4); Sudan (2/4);
Togo (2/4); Yemen (2/4)
</td>
<td style="text-align:left;">
Bolivia (4/4); Comoros (2/4); Egypt (2/4); Ghana (4/4); Guatemala (2/4);
India (2/4); Indonesia (2/4); Kenya (2/4); Lesotho (2/4); Maldives
(2/4); Mauritania (2/4); Namibia (2/4); Papua New Guinea (2/4); Sao Tome
&amp; Principe (2/4); Solomon Islands (2/4); Sudan (2/4); Togo (2/4);
Zimbabwe (2/4)
</td>
<td style="text-align:left;">
Azerbaijan (2/4); Egypt (2/4); Eswatini (2/4); Indonesia (2/4); Kiribati
(2/4); Maldives (2/4); Myanmar (2/4); Namibia (2/4); Papua New Guinea
(2/4); Peru (2/4); Tajikistan (2/4); Turkmenistan (2/4); Uzbekistan
(2/4)
</td>
<td style="text-align:left;">
Azerbaijan (2/4); Djibouti (2/4); Gabon (2/4); Kazakhstan (4/4);
Kiribati (2/4); Mongolia (4/4); Myanmar (2/4); Turkmenistan (2/4)
</td>
<td style="text-align:left;">
Lesotho (2/4)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
q3
</td>
<td style="text-align:left;">
Honduras (2/4); Nicaragua (2/4)
</td>
<td style="text-align:left;">
Algeria (2/4); Cape Verde (4/4); China (2/4); Ecuador (2/4); El Salvador
(2/4); Iran (2/4); Iraq (2/4); Libya (2/4); Oman (2/4); Palestinian
Territory (4/4); Paraguay (2/4); Solomon Islands (2/4); Suriname (2/4)
</td>
<td style="text-align:left;">
Armenia (2/4); Brazil (2/4); El Salvador (2/4); Iran (2/4); Iraq (2/4);
Mexico (2/4); Moldova (2/4); Oman (2/4); Peru (2/4); Suriname (2/4);
Trinidad &amp; Tobago (2/4); Uzbekistan (2/4); Vanuatu (4/4)
</td>
<td style="text-align:left;">
Armenia (2/4); Ecuador (2/4); Honduras (2/4); Hungary (2/4); Nicaragua
(2/4); Paraguay (2/4); Philippines (2/4); Trinidad &amp; Tobago (2/4)
</td>
<td style="text-align:left;">
Algeria (2/4); Brazil (2/4); China (2/4); Libya (2/4); Moldova (2/4);
Philippines (2/4)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
q4
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Bahrain (2/4); Saint Lucia (2/4); Saint Vincent &amp; the Grenadines
(2/4); Syria (2/4); Venezuela (2/4)
</td>
<td style="text-align:left;">
Antigua &amp; Barbuda (2/4); Argentina (2/4); Bahamas (2/4); Bosnia
&amp; Herzegovina (2/4); Bulgaria (2/4); Grenada (2/4); Kuwait (2/4);
Lebanon (2/4); Mauritius (2/4); Mexico (2/4); Seychelles (2/4); Sri
Lanka (2/4); Syria (2/4); Thailand (2/4)
</td>
<td style="text-align:left;">
Bosnia &amp; Herzegovina (2/4); Czech Republic (2/4); Grenada (2/4);
Hungary (2/4); Lebanon (2/4); Mauritius (2/4); Poland (2/4); Qatar
(2/4); Saint Vincent &amp; the Grenadines (2/4); Seychelles (2/4); Sri
Lanka (2/4); Thailand (2/4); Venezuela (2/4)
</td>
<td style="text-align:left;">
Antigua &amp; Barbuda (2/4); Argentina (2/4); Bahamas (2/4); Bahrain
(2/4); Bulgaria (2/4); Kuwait (2/4); Poland (2/4); Saint Lucia (2/4)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
q5
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Austria (2/4); Cuba (2/4); Cyprus (2/4); Greece (2/4); Singapore (2/4);
Switzerland (2/4); Taiwan (2/4); United States of America (2/4)
</td>
<td style="text-align:left;">
Cuba (2/4); Czech Republic (2/4); Germany (2/4); Iceland (4/4); Israel
(2/4); Italy (2/4); Japan (2/4); Luxembourg (2/4); Malta (2/4);
Netherlands (2/4); New Zealand (2/4); Portugal (2/4); Qatar (2/4);
Slovenia (2/4); Spain (2/4); United Kingdom (2/4)
</td>
<td style="text-align:left;">
Australia (4/4); Austria (2/4); Belgium (4/4); Canada (4/4); Cyprus
(2/4); Denmark (4/4); Finland (4/4); France (4/4); Germany (2/4); Greece
(2/4); Ireland (4/4); Israel (2/4); Italy (2/4); Japan (2/4); Luxembourg
(2/4); Malta (2/4); Netherlands (2/4); New Zealand (2/4); Norway (4/4);
Portugal (2/4); Singapore (2/4); Slovenia (2/4); Spain (2/4); Sweden
(4/4); Switzerland (2/4); Taiwan (2/4); United Kingdom (2/4); United
States of America (2/4)
</td>
</tr>
</tbody>
</table>
</div>
<div id="new-version-of-classification-based-on-standardized-data"
class="section level4">
<h4>New version of classification based on standardized data</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable</span>(result<span class="sc">$</span>table_st, <span class="at">format =</span> <span class="st">&quot;html&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">&quot;Gender&quot;</span> <span class="ot">=</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">group_rows</span>(<span class="st">&quot;Health&quot;</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span></code></pre></div>
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Gender
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Q1
</th>
<th style="text-align:left;">
Q2
</th>
<th style="text-align:left;">
Q3
</th>
<th style="text-align:left;">
Q4
</th>
<th style="text-align:left;">
Q5
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="6" style="border-bottom: 1px solid;">
<strong>Health</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q1
</td>
<td style="text-align:left;">
Afghanistan; Angola; Benin; Burkina Faso; Cameroon; Central African
Republic; Chad; Congo, DRC; Cote d’Ivoire; Equatorial Guinea; Eritrea;
Ethiopia; Guinea; Guinea-Bissau; Liberia; Malawi; Mali; Mozambique;
Niger; Nigeria; Sierra Leone; Somalia; Tanzania; Uganda; Zambia
</td>
<td style="text-align:left;">
Burundi; Cambodia; Haiti; Laos; Madagascar; Rwanda
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q2
</td>
<td style="text-align:left;">
Bangladesh; Bhutan; Comoros; Congo; Gambia; Nepal; Pakistan; Sao Tome
&amp; Principe; Senegal; Sudan; Togo; Yemen
</td>
<td style="text-align:left;">
Bolivia; Djibouti; Egypt; Eswatini; Gabon; Ghana; Guatemala; India;
Kenya; Maldives; Mauritania; Papua New Guinea; Zimbabwe
</td>
<td style="text-align:left;">
Botswana; Indonesia; Kiribati; Myanmar; Namibia; Tajikistan
</td>
<td style="text-align:left;">
Azerbaijan; Mongolia; Turkmenistan
</td>
<td style="text-align:left;">
Lesotho
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q3
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Belize; Cape Verde; Honduras; Iran; Iraq; Morocco; Nicaragua; Oman;
Palestinian Territory; Saudi Arabia; Solomon Islands; Turkey
</td>
<td style="text-align:left;">
Algeria; Armenia; Brazil; China; Dominican Republic; Ecuador; El
Salvador; Fiji; Guyana; Jordan; Kyrgyzstan; Libya; Micronesia; Paraguay;
Peru; South Africa; Suriname; Tunisia; Uzbekistan; Vanuatu; Viet Nam
</td>
<td style="text-align:left;">
Georgia; Kazakhstan; Moldova; North Korea; Philippines; Russian
Federation; Trinidad &amp; Tobago
</td>
<td style="text-align:left;">
Latvia; Samoa
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q4
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Syria
</td>
<td style="text-align:left;">
Colombia; Grenada; Jamaica; Macedonia; Mauritius; Mexico; Panama; Saint
Lucia; Saint Vincent &amp; the Grenadines; Thailand; United Arab
Emirates; Venezuela
</td>
<td style="text-align:left;">
Albania; Antigua &amp; Barbuda; Argentina; Bahamas; Bahrain; Bosnia
&amp; Herzegovina; Brunei; Bulgaria; Chile; Croatia; Czech Republic;
Kuwait; Lebanon; Lithuania; Malaysia; Romania; Seychelles; Slovakia;
South Korea; Sri Lanka; Ukraine; Uruguay
</td>
<td style="text-align:left;">
Belarus; Estonia; Hungary; Poland; Tonga
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q5
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Costa Rica; Cuba
</td>
<td style="text-align:left;">
Barbados; Cyprus; Qatar; Singapore; Taiwan; United States of America
</td>
<td style="text-align:left;">
Australia; Austria; Belgium; Canada; Denmark; Finland; France; Germany;
Greece; Iceland; Ireland; Israel; Italy; Japan; Luxembourg; Malta;
Netherlands; New Zealand; Norway; Portugal; Slovenia; Spain; Sweden;
Switzerland; United Kingdom
</td>
</tr>
</tbody>
</table>
<!-- #### Merging classifications into dataset -->
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>variables<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;health_class&quot;</span>, <span class="st">&quot;gender_class&quot;</span>, <span class="st">&quot;health_class_alt&quot;</span>, <span class="st">&quot;gender_class_alt&quot;</span>, <span class="st">&quot;health_flag&quot;</span>, <span class="st">&quot;gender_flag&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(result<span class="sc">$</span>standardized[, <span class="fu">names</span>(result<span class="sc">$</span>standardized) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>, variables<span class="sc">$</span>class)])</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># flagged &lt;- df[df$year == 1990 &amp; (df$health_flag == 1 | df$gender_flag == 1), c(&quot;country&quot;, variables$class)]</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>df<span class="sc">$</span>class_vv <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>df<span class="sc">$</span>class_vv[df<span class="sc">$</span>health_class <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> df<span class="sc">$</span>gender_class <span class="sc">&lt;</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;low&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>df<span class="sc">$</span>class_vv[df<span class="sc">$</span>health_class <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> df<span class="sc">$</span>gender_class <span class="sc">&gt;</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;upp&quot;</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>df<span class="sc">$</span>class_vv[<span class="sc">!</span>(df<span class="sc">$</span>health_class <span class="sc">&lt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> df<span class="sc">$</span>gender_class <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">&amp;</span> <span class="sc">!</span>(df<span class="sc">$</span>health_class <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">&amp;</span> df<span class="sc">$</span>gender_class <span class="sc">&gt;</span> <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;mid&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>df<span class="sc">$</span>class_vv[df<span class="sc">$</span>class_vv <span class="sc">==</span> <span class="st">&quot;mid&quot;</span> <span class="sc">&amp;</span> df<span class="sc">$</span>health_class <span class="sc">&gt;</span> df<span class="sc">$</span>gender_class] <span class="ot">&lt;-</span> <span class="st">&quot;H&gt;G&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>df<span class="sc">$</span>class_vv[df<span class="sc">$</span>class_vv <span class="sc">==</span> <span class="st">&quot;mid&quot;</span> <span class="sc">&amp;</span> df<span class="sc">$</span>health_class <span class="sc">&lt;</span> df<span class="sc">$</span>gender_class] <span class="ot">&lt;-</span> <span class="st">&quot;G&gt;H&quot;</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># addmargins(table(df$class_vv, df$class))</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>df<span class="sc">$</span>class_low <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>class_vv <span class="sc">==</span> <span class="st">&quot;low&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>df<span class="sc">$</span>class_upp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>class_vv <span class="sc">==</span> <span class="st">&quot;upp&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>df<span class="sc">$</span>class_mid <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>class_vv <span class="sc">==</span> <span class="st">&quot;mid&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>df<span class="sc">$</span>class_HG <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>class_vv <span class="sc">==</span> <span class="st">&quot;H&gt;G&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>df<span class="sc">$</span>class_GH <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>class_vv <span class="sc">==</span> <span class="st">&quot;G&gt;H&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>df<span class="sc">$</span>health_class_low <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>health_class <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>df<span class="sc">$</span>health_class_upp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>health_class <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>df<span class="sc">$</span>gender_class_low <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>gender_class <span class="sc">&lt;</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>df<span class="sc">$</span>gender_class_upp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>gender_class <span class="sc">&gt;</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>variables<span class="sc">$</span>class_core <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;class&quot;</span>, <span class="st">&quot;health_class&quot;</span>, <span class="st">&quot;gender_class&quot;</span>, <span class="st">&quot;class_vv&quot;</span>)</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>class1975 <span class="ot">&lt;-</span> df[df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1975</span>, variables<span class="sc">$</span>class_core]</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="fu">names</span>(class1975) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;health&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;class_vv&quot;</span>), <span class="dv">1975</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>class1990 <span class="ot">&lt;-</span> df[df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1990</span>, variables<span class="sc">$</span>class_core]</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="fu">names</span>(class1990) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;health&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;class_vv&quot;</span>), <span class="dv">1990</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a>class1995 <span class="ot">&lt;-</span> df[df<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1995</span>, variables<span class="sc">$</span>class_core]</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="fu">names</span>(class1995) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;health&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;class_vv&quot;</span>), <span class="dv">1995</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(data, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>), <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(df, class1975, <span class="at">by =</span> <span class="st">&quot;country&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(df, class1990, <span class="at">by =</span> <span class="st">&quot;country&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">merge</span>(df, class1995, <span class="at">by =</span> <span class="st">&quot;country&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="fu">order</span>(df<span class="sc">$</span>country, df<span class="sc">$</span>year), </span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;period&quot;</span>, <span class="fu">names</span>(df)[<span class="sc">!</span><span class="fu">names</span>(df) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;period&quot;</span>)])]</span></code></pre></div>
<!-- ### Classification trajectories (in 5-year increments based on global distributions in same time period) -->
<!-- ### Descriptives of control variables by 1990 classification: mean (SD) -->
</div>
<div id="which-countries-move-more-than-2-cells" class="section level4">
<h4>Which countries move more than 2 cells?</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df<span class="sc">$</span>class_num <span class="ot">&lt;-</span> df<span class="sc">$</span>health_class <span class="sc">*</span> df<span class="sc">$</span>gender_class</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">names</span>(years) <span class="ot">&lt;-</span> years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>, <span class="dv">2015</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">lapply</span>(years, <span class="cf">function</span>(year) {</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df[df<span class="sc">$</span>year <span class="sc">==</span> year, <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;class_num&quot;</span>)])</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">names</span>(df)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;class&quot;</span>, year, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>})</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="at">f =</span> <span class="cf">function</span>(...) <span class="fu">merge</span>(..., <span class="at">by =</span> <span class="st">&quot;country&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>), <span class="at">x =</span> dat)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>dat<span class="sc">$</span>diff <span class="ot">&lt;-</span> dat<span class="sc">$</span>class2015 <span class="sc">-</span> dat<span class="sc">$</span>class1990</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>dat<span class="sc">$</span>diff_alt <span class="ot">&lt;-</span> dat<span class="sc">$</span>class2015 <span class="sc">-</span> dat<span class="sc">$</span>class1995</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>better <span class="ot">&lt;-</span> dat[<span class="fu">IsTrue</span>(dat<span class="sc">$</span>diff <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">|</span> dat<span class="sc">$</span>diff_alt <span class="sc">&gt;</span> <span class="dv">2</span>), ]</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>worse <span class="ot">&lt;-</span> dat[<span class="fu">IsTrue</span>(dat<span class="sc">$</span>diff <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">|</span> dat<span class="sc">$</span>diff_alt <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>), ]</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>better </span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class1990"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["class1995"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["class2015"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["diff_alt"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Armenia","2":"NA","3":"9","4":"12","5":"NA","6":"3"},{"1":"Bahrain","2":"12","3":"16","4":"16","5":"4","6":"0"},{"1":"Belize","2":"8","3":"6","4":"9","5":"1","6":"3"},{"1":"Bhutan","2":"1","3":"2","4":"4","5":"3","6":"2"},{"1":"China","2":"9","3":"9","4":"12","5":"3","6":"3"},{"1":"Cyprus","2":"20","3":"20","4":"25","5":"5","6":"5"},{"1":"Czech Republic","2":"NA","3":"16","4":"25","5":"NA","6":"9"},{"1":"Ecuador","2":"9","3":"9","4":"12","5":"3","6":"3"},{"1":"El Salvador","2":"6","3":"9","4":"9","5":"3","6":"0"},{"1":"Eritrea","2":"NA","3":"1","4":"4","5":"NA","6":"3"},{"1":"Honduras","2":"9","3":"6","4":"9","5":"0","6":"3"},{"1":"Indonesia","2":"6","3":"6","4":"9","5":"3","6":"3"},{"1":"Iran","2":"4","3":"6","4":"9","5":"5","6":"3"},{"1":"Kyrgyzstan","2":"NA","3":"9","4":"12","5":"NA","6":"3"},{"1":"Latvia","2":"NA","3":"15","4":"20","5":"NA","6":"5"},{"1":"Lithuania","2":"NA","3":"16","4":"20","5":"NA","6":"4"},{"1":"Macedonia","2":"NA","3":"12","4":"16","5":"NA","6":"4"},{"1":"Maldives","2":"4","3":"4","4":"16","5":"12","6":"12"},{"1":"Mongolia","2":"10","3":"8","4":"12","5":"2","6":"4"},{"1":"Nicaragua","2":"4","3":"6","4":"9","5":"5","6":"3"},{"1":"Oman","2":"6","3":"6","4":"12","5":"6","6":"6"},{"1":"Qatar","2":"20","3":"20","4":"25","5":"5","6":"5"},{"1":"South Korea","2":"16","3":"16","4":"20","5":"4","6":"4"},{"1":"Tunisia","2":"9","3":"9","4":"12","5":"3","6":"3"},{"1":"Turkey","2":"6","3":"6","4":"12","5":"6","6":"6"},{"1":"Uzbekistan","2":"NA","3":"9","4":"12","5":"NA","6":"3"}],"options":{"columns":{"min":[10],"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>worse</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class1990"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["class1995"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["class2015"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["diff"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["diff_alt"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Albania","2":"20","3":"16","4":"16","5":"-4","6":"0"},{"1":"Argentina","2":"16","3":"16","4":"12","5":"-4","6":"-4"},{"1":"Bahamas","2":"16","3":"16","4":"12","5":"-4","6":"-4"},{"1":"Barbados","2":"20","3":"20","4":"12","5":"-8","6":"-8"},{"1":"Brazil","2":"12","3":"9","4":"9","5":"-3","6":"0"},{"1":"Chile","2":"16","3":"16","4":"12","5":"-4","6":"-4"},{"1":"Costa Rica","2":"20","3":"15","4":"12","5":"-8","6":"-3"},{"1":"Dominican Republic","2":"9","3":"9","4":"6","5":"-3","6":"-3"},{"1":"Fiji","2":"12","3":"9","4":"6","5":"-6","6":"-3"},{"1":"Georgia","2":"NA","3":"12","4":"9","5":"NA","6":"-3"},{"1":"Greece","2":"25","3":"25","4":"20","5":"-5","6":"-5"},{"1":"Guyana","2":"9","3":"9","4":"6","5":"-3","6":"-3"},{"1":"Hungary","2":"20","3":"20","4":"16","5":"-4","6":"-4"},{"1":"Jamaica","2":"12","3":"12","4":"9","5":"-3","6":"-3"},{"1":"Jordan","2":"12","3":"9","4":"9","5":"-3","6":"0"},{"1":"Lesotho","2":"10","3":"10","4":"4","5":"-6","6":"-6"},{"1":"Mauritania","2":"4","3":"4","4":"1","5":"-3","6":"-3"},{"1":"Mauritius","2":"12","3":"12","4":"9","5":"-3","6":"-3"},{"1":"Mexico","2":"9","3":"12","4":"9","5":"0","6":"-3"},{"1":"New Zealand","2":"25","3":"25","4":"20","5":"-5","6":"-5"},{"1":"North Korea","2":"16","3":"12","4":"12","5":"-4","6":"0"},{"1":"Philippines","2":"15","3":"12","4":"9","5":"-6","6":"-3"},{"1":"Romania","2":"16","3":"16","4":"12","5":"-4","6":"-4"},{"1":"Saint Vincent & the Grenadines","2":"12","3":"12","4":"9","5":"-3","6":"-3"},{"1":"Samoa","2":"15","3":"15","4":"12","5":"-3","6":"-3"},{"1":"Seychelles","2":"16","3":"16","4":"9","5":"-7","6":"-7"},{"1":"South Africa","2":"9","3":"9","4":"6","5":"-3","6":"-3"},{"1":"Sri Lanka","2":"20","3":"16","4":"16","5":"-4","6":"0"},{"1":"Thailand","2":"16","3":"12","4":"12","5":"-4","6":"0"},{"1":"Tonga","2":"20","3":"20","4":"12","5":"-8","6":"-8"},{"1":"Ukraine","2":"NA","3":"16","4":"12","5":"NA","6":"-4"},{"1":"United States of America","2":"25","3":"20","4":"20","5":"-5","6":"0"},{"1":"Uruguay","2":"20","3":"16","4":"12","5":"-8","6":"-4"},{"1":"Venezuela","2":"12","3":"12","4":"9","5":"-3","6":"-3"},{"1":"Viet Nam","2":"16","3":"9","4":"9","5":"-7","6":"0"}],"options":{"columns":{"min":[10],"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="removing-countries-with-untrustworthy-statistics"
class="section level4">
<h4>Removing countries with untrustworthy statistics</h4>
<p>All data is subject to measurement error. This is particularly
problematic if measurement is systematically biased. Without other data
to validate a given measure, this is a very difficult to problem to
overcome. We only use data from reputable sources, such as academic
centre and international organizations, but some self-reported data are
still suspect. The World Bank and some NGOs have attempted to rate the
capacity of National Statistical System, and some countries are not
inlcuded in their rankings because assessments could be not be made
based on available information. For instance, the ODIN rankings from
2015 to 2018 do not include the Central African Republic, Eritrea,
Equatorial Guinea, and North Korea. Interestingly, among these, only
North Korea is relatively highly ranked on the gender and health
dimensions according to these data, which is simply not believable.
Therefore, we remove only North Korea from the analyses.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>country <span class="sc">!=</span> <span class="st">&quot;North Korea&quot;</span>, ]</span></code></pre></div>
</div>
<div id="trends-by-classification-groups-over-time"
class="section level4 tabset tabset-fade tabset-pills">
<h4 class="tabset tabset-fade tabset-pills">Trends by classification
groups over time</h4>
<div id="life-expectancy" class="section level5">
<h5>Life expectancy</h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df<span class="sc">$</span>class_vv <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span>class_vv, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;G&gt;H&quot;</span>, <span class="st">&quot;H&gt;G&quot;</span>, <span class="st">&quot;mid&quot;</span>, <span class="st">&quot;upp&quot;</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1970</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(class_vv)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> life_exp_wpp, <span class="at">group =</span> class_vv, <span class="at">color =</span> class_vv), </span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> life_exp_wpp), </span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Classifications&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="classifications_files/figure-html/trend_life-1.png" width="67%" height="67%" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="fl">6.5</span>, <span class="at">filename =</span> <span class="st">&quot;_figures/trend_life_exp_wpp.pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="imr" class="section level5">
<h5>IMR</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1970</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(class_vv)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="sc">-</span>imr_wpp, <span class="at">group =</span> class_vv, <span class="at">color =</span> class_vv), </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="sc">-</span>imr_wpp), </span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Classifications&quot;</span>) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="classifications_files/figure-html/trend_imr-1.png" width="67%" height="67%" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="fl">6.5</span>, <span class="at">filename =</span> <span class="st">&quot;_figures/trend_imr_wpp.pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="mys" class="section level5">
<h5>MYS</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1970</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(class_vv)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mys_age_ratio_ihme, <span class="at">group =</span> class_vv, <span class="at">color =</span> class_vv), </span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mys_age_ratio_ihme), </span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Classifications&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="classifications_files/figure-html/trend_mys-1.png" width="67%" height="67%" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="fl">6.5</span>, <span class="at">filename =</span> <span class="st">&quot;_figures/trend_mys_age_ratio_ihme.pdf&quot;</span>)</span></code></pre></div>
</div>
<div id="asfr" class="section level5">
<h5>ASFR</h5>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1970</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(class_vv)) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="sc">-</span>asfr_adol_wpp, <span class="at">group =</span> class_vv, <span class="at">color =</span> class_vv), </span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="sc">-</span>asfr_adol_wpp), </span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                 <span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Classifications&quot;</span>) <span class="sc">+</span> </span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="classifications_files/figure-html/trend_asfr-1.png" width="67%" height="67%" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">device =</span> <span class="st">&quot;pdf&quot;</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">width =</span> <span class="fl">6.5</span>, <span class="at">filename =</span> <span class="st">&quot;_figures/trend_asfr_adol_wpp.pdf&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="trends-by-1995-classification-groups"
class="section level4 tabset tabset-fade tabset-pills">
<h4 class="tabset tabset-fade tabset-pills">Trends by 1995
classification groups</h4>
<div id="health-gender" class="section level5">
<h5>Health &amp; gender</h5>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.factor</span>(df<span class="sc">$</span>class_vv1990))</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.factor</span>(df<span class="sc">$</span>class_vv1995))</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">c</span>(variables<span class="sc">$</span>health_full, variables<span class="sc">$</span>gender_full), <span class="cf">function</span>(var) {</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> df[<span class="sc">!</span><span class="fu">is.na</span>(df<span class="sc">$</span>class_vv1995) <span class="sc">&amp;</span> df<span class="sc">$</span>class_vv1995 <span class="sc">!=</span> <span class="st">&quot;mid&quot;</span>, ]</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(var), <span class="at">group =</span> class_vv1995, <span class="at">color =</span> class_vv1995)) <span class="sc">+</span> </span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">1980</span>, <span class="dv">2018</span>) <span class="sc">+</span> </span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(var, <span class="st">&quot;average by 1995 classification over time&quot;</span>))</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="classifications_files/figure-html/categories-1.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-2.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-3.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-4.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-5.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-6.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-7.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-8.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-9.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-10.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-11.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-12.png" width="67%" height="67%" /><img src="classifications_files/figure-html/categories-13.png" width="67%" height="67%" /></p>
</div>
<div id="cumulative-death-rates" class="section level5">
<h5>Cumulative death rates</h5>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">lapply</span>(variables<span class="sc">$</span>death_rates, <span class="cf">function</span>(var) {</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> df[<span class="sc">!</span><span class="fu">is.na</span>(df<span class="sc">$</span>class_vv1995) <span class="sc">&amp;</span> df<span class="sc">$</span>class_vv1995 <span class="sc">!=</span> <span class="st">&quot;mid&quot;</span>, ]</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="fu">log</span>(<span class="sc">!!</span><span class="fu">sym</span>(<span class="fu">paste</span>(var, <span class="st">&quot;cumulative1991&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="sc">+</span> <span class="dv">1</span>), </span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                  <span class="at">group =</span> class_vv1995, <span class="at">color =</span> class_vv1995)) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">1990</span>, <span class="dv">2018</span>) <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(var, <span class="st">&quot;annual cumulative average (logged) since 1991 by 1995 classification&quot;</span>))</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="classifications_files/figure-html/deaths-1.png" width="67%" height="67%" /><img src="classifications_files/figure-html/deaths-2.png" width="67%" height="67%" /><img src="classifications_files/figure-html/deaths-3.png" width="67%" height="67%" /><img src="classifications_files/figure-html/deaths-4.png" width="67%" height="67%" /><img src="classifications_files/figure-html/deaths-5.png" width="67%" height="67%" /><img src="classifications_files/figure-html/deaths-6.png" width="67%" height="67%" /><img src="classifications_files/figure-html/deaths-7.png" width="67%" height="67%" /></p>
</div>
<div id="cumulative-repression" class="section level5">
<h5>Cumulative repression</h5>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">lapply</span>(variables<span class="sc">$</span>measurement_models, <span class="cf">function</span>(var) {</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> df[<span class="sc">!</span><span class="fu">is.na</span>(df<span class="sc">$</span>class_vv1995) <span class="sc">&amp;</span> df<span class="sc">$</span>class_vv1995 <span class="sc">!=</span> <span class="st">&quot;mid&quot;</span>, ]</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(<span class="fu">paste</span>(var, <span class="st">&quot;cumulative1991&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)), </span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                  <span class="at">group =</span> class_vv1995, <span class="at">color =</span> class_vv1995)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1990</span>, <span class="dv">2018</span>) <span class="sc">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste</span>(var, <span class="st">&quot;annual cumulative average since 1991 by 1995 classification&quot;</span>))</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="classifications_files/figure-html/violence-1.png" width="67%" height="67%" /><img src="classifications_files/figure-html/violence-2.png" width="67%" height="67%" /><img src="classifications_files/figure-html/violence-3.png" width="67%" height="67%" /><img src="classifications_files/figure-html/violence-4.png" width="67%" height="67%" /></p>
</div>
<div id="conflict-incidence" class="section level5">
<h5>Conflict incidence</h5>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">lapply</span>(variables<span class="sc">$</span>conflict_incidence, <span class="cf">function</span>(var) {</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> df[df<span class="sc">$</span>year <span class="sc">&gt;</span> <span class="dv">1988</span>, ]</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">tapply</span>(dat[, var], <span class="fu">list</span>(<span class="at">health =</span> dat<span class="sc">$</span>health1995, <span class="at">gender =</span> dat<span class="sc">$</span>gender1995), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> dat[<span class="sc">!</span><span class="fu">is.na</span>(dat<span class="sc">$</span>class_vv1995) <span class="sc">&amp;</span> dat<span class="sc">$</span>class_vv1995 <span class="sc">!=</span> <span class="st">&quot;mid&quot;</span>, ]</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> <span class="sc">!!</span><span class="fu">sym</span>(var), <span class="at">group =</span> class_vv1995, <span class="at">color =</span> class_vv1995)) <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="dv">1989</span>, <span class="dv">2018</span>) <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste</span>(var, <span class="st">&quot; incidence by classification in 1995&quot;</span>))</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(tbl, plot))</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="classifications_files/figure-html/incidence-1.png" width="67%" height="67%" /><img src="classifications_files/figure-html/incidence-2.png" width="67%" height="67%" /><img src="classifications_files/figure-html/incidence-3.png" width="67%" height="67%" /><img src="classifications_files/figure-html/incidence-4.png" width="67%" height="67%" /></p>
<!-- #### Mean growth rates by classification with t-test (alt H: mean different from global) -->
<!-- #### Preparing cross-sectional dataset -->
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>dfp <span class="ot">&lt;-</span> df</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>dfp<span class="sc">$</span>life_exp_wpp_avg_scaled <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(dfp<span class="sc">$</span>life_exp_wpp_avg))</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>dfp<span class="sc">$</span>imr_wpp_avg_scaled <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(dfp<span class="sc">$</span>imr_wpp_avg))</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>dfp<span class="sc">$</span>mys_age_ratio_ihme_avg_scaled <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(dfp<span class="sc">$</span>mys_age_ratio_ihme_avg))</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>dfp<span class="sc">$</span>asfr_adol_wpp_avg_scaled <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(dfp<span class="sc">$</span>asfr_adol_wpp_avg))</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>dfp<span class="sc">$</span>health <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(dfp[, <span class="fu">c</span>(<span class="st">&quot;life_exp_wpp_avg_scaled&quot;</span>, <span class="st">&quot;imr_wpp_avg_scaled&quot;</span>)], <span class="at">na.rm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>dfp<span class="sc">$</span>gender <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(dfp[, <span class="fu">c</span>(<span class="st">&quot;mys_age_ratio_ihme_avg_scaled&quot;</span>, <span class="st">&quot;asfr_adol_wpp_avg_scaled&quot;</span>)], <span class="at">na.rm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pc_rgdpe_pwt&quot;</span>, <span class="st">&quot;life_exp_wpp&quot;</span>, <span class="st">&quot;imr_wpp&quot;</span>, <span class="st">&quot;mys_ratio_hdr&quot;</span>, <span class="st">&quot;mys_age_ratio_ihme&quot;</span>, <span class="st">&quot;asfr_adol_wpp&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">paste</span>(covariates, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co"># covariates &lt;- c(covariates, &quot;oda_provided_const_wdi&quot;, &quot;oda_received_perc_gov_exp_wdi&quot;, &quot;oda_aid_received_const_wdi&quot;, &quot;oda_received_const_wdi&quot;, &quot;oda_received_perc_imports_wdi&quot;, &quot;aid_received_const_wdi&quot;)</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(covariates, <span class="cf">function</span>(var) { <span class="fu">names</span>(df)[<span class="fu">str_detect</span>(<span class="fu">names</span>(df), var)] }))</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">unique</span>(vars[vars <span class="sc">!=</span> <span class="st">&quot;pasfr_adol_wpp&quot;</span>])</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>include <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;class&quot;</span>, <span class="st">&quot;class_vv&quot;</span>, <span class="st">&quot;class_low&quot;</span>, <span class="st">&quot;class_upp&quot;</span>, <span class="st">&quot;health&quot;</span>, <span class="st">&quot;gender&quot;</span>, vars)</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>new1990 <span class="ot">&lt;-</span> dfp[dfp<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1990</span>, <span class="fu">c</span>(include, variables<span class="sc">$</span>death_rates, variables<span class="sc">$</span>measurement_models)]</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>new1995 <span class="ot">&lt;-</span> dfp[dfp<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1995</span>, <span class="fu">c</span>(include, variables<span class="sc">$</span>death_rates, variables<span class="sc">$</span>measurement_models, </span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>  <span class="fu">paste</span>(variables<span class="sc">$</span>conflict_incidence, <span class="st">&quot;cumulative1989&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  <span class="fu">paste</span>(variables<span class="sc">$</span>political, <span class="st">&quot;cumulative1991&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))]</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>new2015 <span class="ot">&lt;-</span> dfp[dfp<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2015</span>, <span class="fu">c</span>(include, </span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="fu">c</span>(variables<span class="sc">$</span>death_rates, variables<span class="sc">$</span>measurement_models), <span class="st">&quot;cumulative1991&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="fu">c</span>(variables<span class="sc">$</span>death_rates, variables<span class="sc">$</span>measurement_models), <span class="st">&quot;cumulative1996&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>  <span class="fu">paste</span>(variables<span class="sc">$</span>conflict_incidence, <span class="st">&quot;cumulative1991&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>  <span class="fu">paste</span>(variables<span class="sc">$</span>conflict_incidence, <span class="st">&quot;cumulative1996&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>  <span class="fu">paste</span>(variables<span class="sc">$</span>political, <span class="st">&quot;cumulative1991&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>  <span class="fu">paste</span>(variables<span class="sc">$</span>political, <span class="st">&quot;cumulative1996&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))]</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="fu">names</span>(new1990)[<span class="fu">names</span>(new1990) <span class="sc">!=</span> <span class="st">&quot;country&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(new1990)[<span class="fu">names</span>(new1990) <span class="sc">!=</span> <span class="st">&quot;country&quot;</span>], <span class="st">&quot;1990&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="fu">names</span>(new1995)[<span class="fu">names</span>(new1995) <span class="sc">!=</span> <span class="st">&quot;country&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(new1995)[<span class="fu">names</span>(new1995) <span class="sc">!=</span> <span class="st">&quot;country&quot;</span>], <span class="st">&quot;1995&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="fu">names</span>(new2015)[<span class="fu">names</span>(new2015) <span class="sc">!=</span> <span class="st">&quot;country&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(new2015)[<span class="fu">names</span>(new2015) <span class="sc">!=</span> <span class="st">&quot;country&quot;</span>], <span class="st">&quot;2015&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">merge</span>(new1990, new1995, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>), <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">merge</span>(new, new2015, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>), <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="do">## growth vars </span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a>new<span class="sc">$</span>health_growth1990_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>health_2015 <span class="sc">-</span> new<span class="sc">$</span>health_1990</span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>new<span class="sc">$</span>health_growth1995_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>health_2015 <span class="sc">-</span> new<span class="sc">$</span>health_1995</span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>new<span class="sc">$</span>gender_growth1990_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>gender_2015 <span class="sc">-</span> new<span class="sc">$</span>gender_1990</span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a>new<span class="sc">$</span>gender_growth1995_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>gender_2015 <span class="sc">-</span> new<span class="sc">$</span>gender_1995</span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a>new<span class="sc">$</span>pc_rgdpe_avg_growth1990_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>pc_rgdpe_pwt_avg_2015 <span class="sc">-</span> new<span class="sc">$</span>pc_rgdpe_pwt_avg_1990</span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a>new<span class="sc">$</span>pc_rgdpe_avg_growth1995_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>pc_rgdpe_pwt_avg_2015 <span class="sc">-</span> new<span class="sc">$</span>pc_rgdpe_pwt_avg_1995</span>
<span id="cb21-37"><a href="#cb21-37" tabindex="-1"></a>new<span class="sc">$</span>life_exp_wpp_avg_growth1990_2015  <span class="ot">&lt;-</span> new<span class="sc">$</span>life_exp_wpp_avg_2015 <span class="sc">-</span> new<span class="sc">$</span>life_exp_wpp_avg_1990</span>
<span id="cb21-38"><a href="#cb21-38" tabindex="-1"></a>new<span class="sc">$</span>life_exp_wpp_avg_growth1995_2015  <span class="ot">&lt;-</span> new<span class="sc">$</span>life_exp_wpp_avg_2015 <span class="sc">-</span> new<span class="sc">$</span>life_exp_wpp_avg_1995</span>
<span id="cb21-39"><a href="#cb21-39" tabindex="-1"></a>new<span class="sc">$</span>imr_wpp_avg_growth1990_2015       <span class="ot">&lt;-</span> new<span class="sc">$</span>imr_wpp_avg_2015      <span class="sc">-</span> new<span class="sc">$</span>imr_wpp_avg_1990</span>
<span id="cb21-40"><a href="#cb21-40" tabindex="-1"></a>new<span class="sc">$</span>imr_wpp_avg_growth1995_2015       <span class="ot">&lt;-</span> new<span class="sc">$</span>imr_wpp_avg_2015      <span class="sc">-</span> new<span class="sc">$</span>imr_wpp_avg_1995</span>
<span id="cb21-41"><a href="#cb21-41" tabindex="-1"></a>new<span class="sc">$</span>mys_ratio_hdr_avg_growth1990_2015 <span class="ot">&lt;-</span> new<span class="sc">$</span>mys_ratio_hdr_avg_2015 <span class="sc">-</span> new<span class="sc">$</span>mys_ratio_hdr_avg_1990</span>
<span id="cb21-42"><a href="#cb21-42" tabindex="-1"></a>new<span class="sc">$</span>mys_age_ratio_ihme_avg_growth1990_2015 <span class="ot">&lt;-</span> new<span class="sc">$</span>mys_age_ratio_ihme_avg_2015 <span class="sc">-</span> new<span class="sc">$</span>mys_age_ratio_ihme_avg_1990</span>
<span id="cb21-43"><a href="#cb21-43" tabindex="-1"></a>new<span class="sc">$</span>asfr_adol_wpp_avg_growth1990_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>asfr_adol_wpp_avg_2015      <span class="sc">-</span> new<span class="sc">$</span>asfr_adol_wpp_avg_1990</span>
<span id="cb21-44"><a href="#cb21-44" tabindex="-1"></a>new<span class="sc">$</span>asfr_adol_wpp_avg_growth1995_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>asfr_adol_wpp_avg_2015      <span class="sc">-</span> new<span class="sc">$</span>asfr_adol_wpp_avg_1995</span>
<span id="cb21-45"><a href="#cb21-45" tabindex="-1"></a>new<span class="sc">$</span>mys_ratio_hdr_avg_growth1995_2015      <span class="ot">&lt;-</span> new<span class="sc">$</span>mys_ratio_hdr_avg_2015      <span class="sc">-</span> new<span class="sc">$</span>mys_ratio_hdr_avg_1995</span>
<span id="cb21-46"><a href="#cb21-46" tabindex="-1"></a>new<span class="sc">$</span>mys_age_ratio_ihme_avg_growth1995_2015 <span class="ot">&lt;-</span> new<span class="sc">$</span>mys_age_ratio_ihme_avg_2015 <span class="sc">-</span> new<span class="sc">$</span>mys_age_ratio_ihme_avg_1995</span>
<span id="cb21-47"><a href="#cb21-47" tabindex="-1"></a><span class="co"># summary(new[, c(&quot;mys_ratio_hdr_avg_growth1990_2015&quot;, &quot;mys_ratio_hdr_avg_growth1995_2015&quot;, &quot;mys_age_ratio_ihme_avg_growth1990_2015&quot;)])</span></span>
<span id="cb21-48"><a href="#cb21-48" tabindex="-1"></a><span class="do">## logged version of pcGDP growth vars; need to account for negative values</span></span>
<span id="cb21-49"><a href="#cb21-49" tabindex="-1"></a>new<span class="sc">$</span>lg_pc_rgdpe_avg_growth1990_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1990_2015 <span class="sc">&lt;</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="sc">-</span>new<span class="sc">$</span>pc_rgdpe_avg_growth1990_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1990_2015 <span class="sc">&lt;</span> <span class="dv">0</span>)])</span>
<span id="cb21-50"><a href="#cb21-50" tabindex="-1"></a>new<span class="sc">$</span>lg_pc_rgdpe_avg_growth1990_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1990_2015 <span class="sc">&gt;=</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="fu">log</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1990_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1990_2015 <span class="sc">&gt;=</span> <span class="dv">0</span>)])</span>
<span id="cb21-51"><a href="#cb21-51" tabindex="-1"></a>new<span class="sc">$</span>lg_pc_rgdpe_avg_growth1995_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1995_2015 <span class="sc">&lt;</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="sc">-</span>new<span class="sc">$</span>pc_rgdpe_avg_growth1995_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1995_2015 <span class="sc">&lt;</span> <span class="dv">0</span>)])</span>
<span id="cb21-52"><a href="#cb21-52" tabindex="-1"></a>new<span class="sc">$</span>lg_pc_rgdpe_avg_growth1995_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1995_2015 <span class="sc">&gt;=</span> <span class="dv">0</span>)] <span class="ot">&lt;-</span> <span class="fu">log</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1995_2015[<span class="fu">IsTrue</span>(new<span class="sc">$</span>pc_rgdpe_avg_growth1995_2015 <span class="sc">&gt;=</span> <span class="dv">0</span>)])</span>
<span id="cb21-53"><a href="#cb21-53" tabindex="-1"></a><span class="do">## performance versions of growth measures </span></span>
<span id="cb21-54"><a href="#cb21-54" tabindex="-1"></a>CodePerformance <span class="ot">&lt;-</span> <span class="cf">function</span>(y_var, x_vars, <span class="at">show =</span> <span class="cn">FALSE</span>, <span class="at">prefix =</span> <span class="st">&quot;perf&quot;</span>) {</span>
<span id="cb21-55"><a href="#cb21-55" tabindex="-1"></a>  x_vars <span class="ot">&lt;-</span> <span class="fu">paste</span>(x_vars, <span class="at">collapse =</span> <span class="st">&quot; + &quot;</span>)</span>
<span id="cb21-56"><a href="#cb21-56" tabindex="-1"></a>  equation <span class="ot">&lt;-</span> <span class="fu">paste</span>(y_var, <span class="st">&quot; ~ &quot;</span>, x_vars, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb21-57"><a href="#cb21-57" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">get_all_vars</span>(<span class="at">formula =</span> equation, <span class="at">data =</span> new, <span class="at">country =</span> country))</span>
<span id="cb21-58"><a href="#cb21-58" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> equation, <span class="at">data =</span> df)</span>
<span id="cb21-59"><a href="#cb21-59" tabindex="-1"></a>  df<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod)</span>
<span id="cb21-60"><a href="#cb21-60" tabindex="-1"></a>  df[, <span class="fu">paste</span>(prefix, y_var, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)] <span class="ot">&lt;-</span> df[, y_var] <span class="sc">-</span> df<span class="sc">$</span>predicted</span>
<span id="cb21-61"><a href="#cb21-61" tabindex="-1"></a>  <span class="cf">if</span>(show) <span class="fu">print</span>(df)</span>
<span id="cb21-62"><a href="#cb21-62" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">invisible</span>(df[, <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="fu">paste</span>(prefix, y_var, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))]))</span>
<span id="cb21-63"><a href="#cb21-63" tabindex="-1"></a>}</span>
<span id="cb21-64"><a href="#cb21-64" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;life_exp_wpp&quot;</span>, <span class="st">&quot;imr_wpp&quot;</span>, <span class="st">&quot;mys_ratio_hdr&quot;</span>, <span class="st">&quot;mys_age_ratio_ihme&quot;</span>, <span class="st">&quot;asfr_adol_wpp&quot;</span>)</span>
<span id="cb21-65"><a href="#cb21-65" tabindex="-1"></a>performance_measures <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">c</span>(<span class="dv">1990</span>, <span class="dv">1995</span>), <span class="cf">function</span>(year) {</span>
<span id="cb21-66"><a href="#cb21-66" tabindex="-1"></a>  <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">paste</span>(vars, <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="cf">function</span>(var) {</span>
<span id="cb21-67"><a href="#cb21-67" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb21-68"><a href="#cb21-68" tabindex="-1"></a>      <span class="fu">CodePerformance</span>(<span class="at">y_var =</span> <span class="fu">paste</span>(var, <span class="st">&quot;_growth&quot;</span>, year, <span class="st">&quot;_2015&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), </span>
<span id="cb21-69"><a href="#cb21-69" tabindex="-1"></a>                      <span class="at">x_vars =</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="fu">str_replace</span>(<span class="fu">paste</span>(<span class="st">&quot;lg&quot;</span>, var, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="st">&quot;lg_mys&quot;</span>, <span class="st">&quot;mys&quot;</span>), <span class="st">&quot;lg_pc_rgdpe_pwt_avg&quot;</span>), year, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)),</span>
<span id="cb21-70"><a href="#cb21-70" tabindex="-1"></a>      <span class="fu">CodePerformance</span>(<span class="at">y_var =</span> <span class="fu">paste</span>(var, <span class="st">&quot;_growth&quot;</span>, year, <span class="st">&quot;_2015&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>), </span>
<span id="cb21-71"><a href="#cb21-71" tabindex="-1"></a>                      <span class="at">x_vars =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="fu">c</span>(<span class="fu">str_replace</span>(<span class="fu">paste</span>(<span class="st">&quot;lg&quot;</span>, var, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), <span class="st">&quot;lg_mys&quot;</span>, <span class="st">&quot;mys&quot;</span>), <span class="st">&quot;lg_pc_rgdpe_pwt_avg&quot;</span>), year, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb21-72"><a href="#cb21-72" tabindex="-1"></a>                                 <span class="fu">paste</span>(<span class="st">&quot;lg_pc_rgdpe_avg_growth&quot;</span>, year, <span class="st">&quot;_2015&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)), <span class="at">prefix =</span> <span class="st">&quot;perfv2&quot;</span>)</span>
<span id="cb21-73"><a href="#cb21-73" tabindex="-1"></a>    ))</span>
<span id="cb21-74"><a href="#cb21-74" tabindex="-1"></a>  }), <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-75"><a href="#cb21-75" tabindex="-1"></a>}), <span class="at">recursive =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-76"><a href="#cb21-76" tabindex="-1"></a>performance_measures <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="at">f =</span> <span class="cf">function</span>(...) <span class="fu">merge</span>(..., <span class="at">by =</span> <span class="st">&quot;country&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>), <span class="at">x =</span> performance_measures)</span>
<span id="cb21-77"><a href="#cb21-77" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">merge</span>(new, performance_measures, <span class="at">by =</span> <span class="st">&quot;country&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="performance-rankings-within-classification-groups"
class="section level4 tabset tabset-fade tabset-pills">
<h4 class="tabset tabset-fade tabset-pills">Performance Rankings within
classification groups</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>Performance <span class="ot">&lt;-</span> <span class="cf">function</span>(category, year, vars) {</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  countries <span class="ot">&lt;-</span> <span class="fu">unique</span>(df<span class="sc">$</span>country[df<span class="sc">$</span>year <span class="sc">==</span> year <span class="sc">&amp;</span> df<span class="sc">$</span>class_vv <span class="sc">%in%</span> category])</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  countries <span class="ot">&lt;-</span> countries[<span class="sc">!</span><span class="fu">is.na</span>(countries)]</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="fu">lapply</span>(vars, <span class="cf">function</span>(var) {</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">paste</span>(var, <span class="st">&quot;_growth&quot;</span>, year, <span class="st">&quot;_2015&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>    <span class="co"># other &lt;- paste(c(&quot;deaths_all_ucdp_rate_cumulative&quot;), year + 1, &quot;_2015&quot;, sep = &quot;&quot;)</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    select_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, var, <span class="fu">paste</span>(<span class="st">&quot;perf&quot;</span>, var, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    dat <span class="ot">&lt;-</span> new[new<span class="sc">$</span>country <span class="sc">%in%</span> countries, select_vars]</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>    dat[<span class="fu">order</span>(dat[, var], <span class="at">decreasing =</span> <span class="cn">TRUE</span>, <span class="at">na.last =</span> <span class="cn">NA</span>), ]</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  })</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>}</span></code></pre></div>
<div id="low-classification" class="section level5">
<h5>Low classification</h5>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">Performance</span>(<span class="at">category =</span> <span class="st">&quot;low&quot;</span>, <span class="at">year =</span> <span class="dv">1995</span>, <span class="at">vars =</span> <span class="fu">paste</span>(<span class="fu">c</span>(variables<span class="sc">$</span>health, variables<span class="sc">$</span>gender), <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>## [[1]]
##                      country imr_wpp_avg_growth1995_2015 perf_imr_wpp_avg_growth1995_2015
## 146                   Rwanda                     156.846                      101.3912469
## 99                   Liberia                      95.964                       42.3135927
## 121               Mozambique                      75.594                       24.3805636
## 106                   Malawi                      74.605                       26.2162437
## 129                    Niger                      73.804                       25.1857254
## 60                  Ethiopia                      68.205                       19.9730276
## 5                     Angola                      66.809                       18.8077701
## 158             Sierra Leone                      65.676                       14.6778973
## 200                   Zambia                      63.350                       16.4489691
## 105               Madagascar                      63.279                       18.7793525
## 72                    Guinea                      62.458                       16.7649099
## 177                 Tanzania                      58.400                       12.3700402
## 28                   Burundi                      58.220                       11.3166145
## 73             Guinea-Bissau                      56.778                        9.6293383
## 29                  Cambodia                      55.983                       13.8259968
## 14                Bangladesh                      55.101                       13.1711233
## 125                    Nepal                      53.220                       10.8322366
## 108                 Maldives                      51.451                       18.5557804
## 130                  Nigeria                      50.889                        1.0561729
## 95                      Laos                      50.837                        7.0510642
## 21                   Bolivia                      50.737                       11.1058381
## 1                Afghanistan                      50.233                               NA
## 163                  Somalia                      49.977                               NA
## 57                   Eritrea                      49.419                               NA
## 109                     Mali                      48.481                       -0.6620037
## 152      Sao Tome &amp; Principe                      47.294                        7.1802441
## 187                   Uganda                      46.314                        0.5358980
## 20                    Bhutan                      45.121                        7.1970863
## 79                     India                      43.026                        2.1733029
## 56         Equatorial Guinea                      42.222                       -3.1673876
## 54                     Egypt                      40.630                        6.4997798
## 198                    Yemen                      40.258                       -2.8373762
## 27              Burkina Faso                      39.229                       -6.0936007
## 40                Congo, DRC                      36.507                       -9.6027826
## 34                      Chad                      34.977                      -12.1948112
## 19                     Benin                      34.516                      -10.1682122
## 154                  Senegal                      33.307                       -4.2066406
## 42             Cote d&#39;Ivoire                      32.958                       -9.6907554
## 133                 Pakistan                      32.943                       -9.5867229
## 90                     Kenya                      32.477                       -5.8731049
## 30                  Cameroon                      32.255                      -10.8602168
## 170                    Sudan                      32.087                       -7.7815213
## 75                     Haiti                      31.413                      -11.8173675
## 71                 Guatemala                      28.370                       -3.9739344
## 180                     Togo                      27.726                      -13.5025632
## 68                     Ghana                      27.665                       -9.7415634
## 65                    Gambia                      26.241                      -11.9742576
## 38                   Comoros                      22.888                      -15.7295000
## 39                     Congo                      22.552                      -13.8280220
## 64                     Gabon                      21.617                      -10.7171053
## 33  Central African Republic                      20.741                      -25.5105135
## 49                  Djibouti                      20.429                      -17.9410187
## 137         Papua New Guinea                      15.575                               NA
## 112               Mauritania                      11.458                      -25.0636787
## 201                 Zimbabwe                      10.623                      -22.6191495
## 59                  Eswatini                       2.495                      -28.0220329
## 
## [[2]]
##                      country life_exp_wpp_avg_growth1995_2015 perf_life_exp_wpp_avg_growth1995_2015
## 146                   Rwanda                            44.00                          15.887747430
## 60                  Ethiopia                            15.63                           5.650604136
## 187                   Uganda                            14.94                           2.734341608
## 20                    Bhutan                            14.60                           5.902054533
## 99                   Liberia                            14.53                           3.932732807
## 129                    Niger                            14.15                           2.063389579
## 158             Sierra Leone                            13.86                          -2.708903706
## 106                   Malawi                            13.42                           1.917542135
## 29                  Cambodia                            13.34                           5.347301573
## 108                 Maldives                            13.05                           7.081762484
## 200                   Zambia                            12.93                           1.459055416
## 57                   Eritrea                            12.65                                    NA
## 5                     Angola                            12.50                          -0.406194854
## 125                    Nepal                            12.05                           5.003278586
## 28                   Burundi                            11.89                           1.070162432
## 105               Madagascar                            11.84                           3.192407111
## 21                   Bolivia                            11.60                           4.147106824
## 177                 Tanzania                            11.24                           1.590811277
## 95                      Laos                            11.06                           3.003057400
## 14                Bangladesh                            10.89                           4.856441365
## 1                Afghanistan                            10.36                                    NA
## 152      Sao Tome &amp; Principe                            10.24                           3.494115297
## 163                  Somalia                             9.90                                    NA
## 109                     Mali                             9.66                          -1.319081995
## 27              Burkina Faso                             9.38                          -0.633706951
## 71                 Guatemala                             8.85                           3.133598785
## 79                     India                             8.65                           2.328120425
## 40                Congo, DRC                             8.51                          -1.392926482
## 154                  Senegal                             8.15                           0.728311568
## 73             Guinea-Bissau                             8.03                          -3.020247189
## 39                     Congo                             7.94                          -0.812666615
## 121               Mozambique                             7.92                          -2.883405004
## 198                    Yemen                             7.81                           1.934690565
## 170                    Sudan                             7.76                          -0.009722093
## 65                    Gambia                             7.42                          -1.993349661
## 90                     Kenya                             7.26                          -0.793547597
## 72                    Guinea                             6.69                          -3.566400225
## 56         Equatorial Guinea                             6.55                          -3.836150330
## 75                     Haiti                             6.38                          -1.306531050
## 130                  Nigeria                             6.08                          -4.906842686
## 137         Papua New Guinea                             5.42                                    NA
## 54                     Egypt                             5.39                           0.587752636
## 133                 Pakistan                             5.20                          -1.076647529
## 34                      Chad                             5.09                          -6.001903473
## 38                   Comoros                             5.01                          -2.628062944
## 19                     Benin                             4.79                          -2.880279864
## 49                  Djibouti                             4.53                          -3.142629792
## 68                     Ghana                             4.04                          -3.429555479
## 30                  Cameroon                             3.68                          -5.726241869
## 180                     Togo                             3.30                          -4.268038482
## 112               Mauritania                             3.06                          -3.680175550
## 64                     Gabon                             2.69                          -4.934800652
## 201                 Zimbabwe                             2.27                          -7.247775492
## 42             Cote d&#39;Ivoire                             1.97                          -7.449719925
## 33  Central African Republic                             0.79                          -9.806296174
## 59                  Eswatini                           -10.23                         -17.519774205
## 
## [[3]]
##                      country asfr_adol_wpp_avg_growth1995_2015 perf_asfr_adol_wpp_avg_growth1995_2015
## 108                 Maldives                            91.781                             60.1260834
## 198                    Yemen                            78.568                             48.5909037
## 20                    Bhutan                            72.961                             43.7194134
## 64                     Gabon                            71.596                             29.9070444
## 79                     India                            65.924                             39.9831798
## 1                Afghanistan                            63.132                                     NA
## 65                    Gambia                            61.531                             26.3442704
## 30                  Cameroon                            56.723                             19.6673251
## 125                    Nepal                            55.789                             25.6220926
## 14                Bangladesh                            54.862                             22.5316196
## 158             Sierra Leone                            51.224                             15.4197319
## 71                 Guatemala                            49.724                             15.7309105
## 57                   Eritrea                            49.605                                     NA
## 5                     Angola                            45.600                              5.4169197
## 187                   Uganda                            45.266                             11.3265250
## 59                  Eswatini                            43.877                              8.4569439
## 34                      Chad                            39.874                              2.1915578
## 60                  Ethiopia                            39.696                             13.5753874
## 154                  Senegal                            39.530                              7.8442646
## 133                 Pakistan                            38.512                             13.0620414
## 95                      Laos                            37.221                             10.0104961
## 72                    Guinea                            34.428                             -3.8228739
## 38                   Comoros                            33.755                              3.0158128
## 68                     Ghana                            32.062                              2.5447268
## 73             Guinea-Bissau                            30.469                             -1.3395534
## 19                     Benin                            30.401                              0.6517475
## 56         Equatorial Guinea                            29.482                             -8.4569928
## 27              Burkina Faso                            29.414                             -1.8426472
## 105               Madagascar                            29.174                             -2.8526655
## 90                     Kenya                            29.107                             -1.1513961
## 121               Mozambique                            28.210                             -4.8440344
## 170                    Sudan                            28.040                             -0.7632682
## 130                  Nigeria                            26.383                             -2.5795097
## 112               Mauritania                            24.939                             -5.1569491
## 54                     Egypt                            24.676                             -1.3977047
## 28                   Burundi                            24.075                              1.7491800
## 152      Sao Tome &amp; Principe                            23.893                             -6.5644302
## 49                  Djibouti                            23.754                              6.9814361
## 42             Cote d&#39;Ivoire                            23.647                            -10.7896306
## 99                   Liberia                            22.375                             -7.6176637
## 129                    Niger                            22.023                            -15.7801338
## 200                   Zambia                            20.739                            -11.9893116
## 137         Papua New Guinea                            19.258                                     NA
## 21                   Bolivia                            19.241                             -8.2675732
## 146                   Rwanda                            18.179                              1.2231159
## 29                  Cambodia                            17.965                             -2.0200652
## 177                 Tanzania                            17.539                            -12.5937879
## 109                     Mali                            17.434                            -17.3424139
## 75                     Haiti                            16.708                             -4.8968046
## 33  Central African Republic                            16.290                            -16.0506019
## 180                     Togo                            15.749                            -12.0272470
## 106                   Malawi                            15.100                            -17.5640206
## 39                     Congo                             7.054                            -24.1600097
## 40                Congo, DRC                            -2.239                            -31.5534031
## 201                 Zimbabwe                            -6.097                            -37.7896235
## 163                  Somalia                            -8.646                                     NA
## 
## [[4]]
##                      country mys_age_ratio_ihme_avg_growth1995_2015 perf_mys_age_ratio_ihme_avg_growth1995_2015
## 30                  Cameroon                             0.14648554                                0.0612413070
## 170                    Sudan                             0.13626133                                0.0447494566
## 130                  Nigeria                             0.12344002                                0.0336568216
## 39                     Congo                             0.11697104                                0.0311043259
## 146                   Rwanda                             0.11660137                                0.0286952324
## 90                     Kenya                             0.11629112                                0.0337503438
## 54                     Egypt                             0.11593173                                0.0326584502
## 14                Bangladesh                             0.10956549                                0.0186126235
## 106                   Malawi                             0.10611083                                0.0149087105
## 27              Burkina Faso                             0.10222984                                0.0086255415
## 79                     India                             0.09932701                                0.0082782437
## 75                     Haiti                             0.09844110                                0.0163274253
## 68                     Ghana                             0.09785328                                0.0149985807
## 177                 Tanzania                             0.09778659                                0.0112233307
## 21                   Bolivia                             0.09537754                                0.0187148364
## 200                   Zambia                             0.09517415                                0.0100993714
## 201                 Zimbabwe                             0.09382767                                0.0204044325
## 28                   Burundi                             0.09256550                                0.0015329189
## 187                   Uganda                             0.09207305                                0.0015532896
## 40                Congo, DRC                             0.09093057                               -0.0015371508
## 71                 Guatemala                             0.09079634                                0.0182446807
## 95                      Laos                             0.08873682                                0.0023467994
## 29                  Cambodia                             0.08868885                                0.0005546678
## 133                 Pakistan                             0.08826692                               -0.0068036407
## 105               Madagascar                             0.08782294                                0.0083582064
## 137         Papua New Guinea                             0.08721162                                          NA
## 154                  Senegal                             0.08642337                               -0.0046602948
## 42             Cote d&#39;Ivoire                             0.08630985                               -0.0058893125
## 56         Equatorial Guinea                             0.08529380                               -0.0034398202
## 5                     Angola                             0.08378592                               -0.0041516773
## 108                 Maldives                             0.08228878                                0.0128646926
## 38                   Comoros                             0.08168754                               -0.0046806703
## 125                    Nepal                             0.08099447                               -0.0201520208
## 121               Mozambique                             0.07931318                               -0.0115207850
## 152      Sao Tome &amp; Principe                             0.07881374                               -0.0077779539
## 180                     Togo                             0.07466429                               -0.0201876963
## 99                   Liberia                             0.07275952                               -0.0268248621
## 19                     Benin                             0.06985488                               -0.0265766268
## 49                  Djibouti                             0.06933037                               -0.0276688069
## 109                     Mali                             0.06804504                               -0.0294066798
## 198                    Yemen                             0.06757382                               -0.0397501730
## 65                    Gambia                             0.06701081                               -0.0241285289
## 33  Central African Republic                             0.06553909                               -0.0309907980
## 57                   Eritrea                             0.06548326                                          NA
## 20                    Bhutan                             0.06441966                               -0.0297379643
## 60                  Ethiopia                             0.06223153                               -0.0357806887
## 158             Sierra Leone                             0.06123827                               -0.0321570024
## 59                  Eswatini                             0.05717336                               -0.0074193116
## 112               Mauritania                             0.05540043                               -0.0306461571
## 129                    Niger                             0.05400718                               -0.0417035119
## 73             Guinea-Bissau                             0.05253559                               -0.0452242995
## 163                  Somalia                             0.05243815                                          NA
## 72                    Guinea                             0.05057056                               -0.0457748168
## 34                      Chad                             0.04819452                               -0.0539283892
## 1                Afghanistan                             0.03395971                                          NA
## 64                     Gabon                            -0.02839036                               -0.0890469402</code></pre>
</div>
<div id="h-g-classification" class="section level5">
<h5>H &gt; G classification</h5>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">Performance</span>(<span class="at">category =</span> <span class="st">&quot;H&gt;G&quot;</span>, <span class="at">year =</span> <span class="dv">1995</span>, <span class="at">vars =</span> <span class="fu">paste</span>(<span class="fu">c</span>(variables<span class="sc">$</span>health, variables<span class="sc">$</span>gender), <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>## [[1]]
##                            country imr_wpp_avg_growth1995_2015 perf_imr_wpp_avg_growth1995_2015
## 184                         Turkey                      44.359                       14.2936829
## 128                      Nicaragua                      30.120                       -0.7064819
## 120                        Morocco                      28.816                       -2.4792142
## 32                      Cape Verde                      25.941                       -5.1229293
## 76                        Honduras                      24.615                       -4.6159226
## 81                            Iran                      24.187                       -2.7039326
## 153                   Saudi Arabia                      21.348                        2.2102819
## 132                           Oman                      21.263                        0.2300472
## 114                         Mexico                      17.921                       -3.8557937
## 104                      Macedonia                      17.611                       -2.7189656
## 178                       Thailand                      15.988                       -3.6131302
## 18                          Belize                      14.724                       -6.7408954
## 135          Palestinian Territory                      13.378                      -11.5841510
## 37                        Colombia                      11.979                       -7.5540300
## 136                         Panama                      10.246                       -9.2467804
## 82                            Iraq                       9.532                      -17.7314197
## 162                Solomon Islands                       9.230                               NA
## 86                         Jamaica                       8.782                      -10.0179259
## 174                          Syria                       8.390                      -16.0018892
## 195                      Venezuela                       8.081                       -9.2250739
## 113                      Mauritius                       6.460                       -6.4455295
## 189           United Arab Emirates                       6.159                        4.2669286
## 41                      Costa Rica                       5.229                       -4.9986724
## 44                            Cuba                       5.138                               NA
## 70                         Grenada                       2.773                      -10.3988376
## 149 Saint Vincent &amp; the Grenadines                       1.916                      -13.1027779
## 148                    Saint Lucia                       1.748                      -11.3294883
## 
## [[2]]
##                            country life_exp_wpp_avg_growth1995_2015 perf_life_exp_wpp_avg_growth1995_2015
## 184                         Turkey                            10.10                             4.0243353
## 120                        Morocco                             9.06                             4.0051914
## 81                            Iran                             8.13                             3.4294616
## 132                           Oman                             7.71                             2.6528900
## 128                      Nicaragua                             7.00                             2.4110522
## 162                Solomon Islands                             6.64                                    NA
## 76                        Honduras                             6.22                             2.1934472
## 32                      Cape Verde                             6.03                             1.5175457
## 37                        Colombia                             5.80                             1.6303841
## 178                       Thailand                             5.03                             0.9557947
## 153                   Saudi Arabia                             4.27                            -0.8700988
## 189           United Arab Emirates                             4.21                            -1.8516102
## 135          Palestinian Territory                             4.14                             0.4677636
## 113                      Mauritius                             3.86                            -0.7582480
## 136                         Panama                             3.75                             0.6488448
## 44                            Cuba                             3.68                                    NA
## 104                      Macedonia                             3.62                             0.1715680
## 148                    Saint Lucia                             3.49                            -0.3809096
## 114                         Mexico                             3.13                            -0.9959311
## 41                      Costa Rica                             3.08                             0.5921070
## 18                          Belize                             2.83                            -1.1539819
## 70                         Grenada                             2.11                            -1.6411043
## 82                            Iraq                             2.07                            -2.1302030
## 195                      Venezuela                             2.04                            -1.9406962
## 149 Saint Vincent &amp; the Grenadines                             1.15                            -2.7453748
## 86                         Jamaica                             0.06                            -2.5902924
## 174                          Syria                            -1.41                            -3.2305688
## 
## [[3]]
##                            country asfr_adol_wpp_avg_growth1995_2015 perf_asfr_adol_wpp_avg_growth1995_2015
## 132                           Oman                            57.914                              29.124497
## 128                      Nicaragua                            53.419                              18.188750
## 148                    Saint Lucia                            50.463                              18.279475
## 153                   Saudi Arabia                            49.452                              21.667205
## 135          Palestinian Territory                            49.295                              18.360479
## 18                          Belize                            49.037                              13.867185
## 70                         Grenada                            48.097                              19.455895
## 76                        Honduras                            47.388                              14.404788
## 86                         Jamaica                            36.901                               6.020554
## 81                            Iran                            36.039                              10.631093
## 41                      Costa Rica                            33.819                               1.988849
## 149 Saint Vincent &amp; the Grenadines                            33.443                               3.280016
## 32                      Cape Verde                            33.045                               2.907274
## 184                         Turkey                            29.023                               3.074924
## 37                        Colombia                            26.210                              -6.140213
## 189           United Arab Emirates                            25.502                              -2.596737
## 104                      Macedonia                            25.154                               6.345250
## 174                          Syria                            24.632                               4.591720
## 114                         Mexico                            18.785                             -12.675681
## 113                      Mauritius                            14.190                              -6.931383
## 44                            Cuba                            12.658                                     NA
## 136                         Panama                            11.135                             -20.904963
## 195                      Venezuela                             7.119                             -24.774590
## 162                Solomon Islands                             6.758                                     NA
## 120                        Morocco                             3.478                             -12.357414
## 178                       Thailand                            -1.338                             -23.033858
## 82                            Iraq                           -12.038                             -35.579436
## 
## [[4]]
##                            country mys_age_ratio_ihme_avg_growth1995_2015 perf_mys_age_ratio_ihme_avg_growth1995_2015
## 153                   Saudi Arabia                             0.11753597                                0.0346828740
## 174                          Syria                             0.11684693                                0.0290317003
## 81                            Iran                             0.11346188                                0.0333402317
## 82                            Iraq                             0.10517058                                0.0198780650
## 162                Solomon Islands                             0.10325700                                          NA
## 113                      Mauritius                             0.09746310                                0.0299673876
## 178                       Thailand                             0.09275372                                0.0267618241
## 120                        Morocco                             0.09091269                                0.0047544320
## 184                         Turkey                             0.08562341                                0.0111629017
## 114                         Mexico                             0.08559812                                0.0216147177
## 76                        Honduras                             0.08490258                                0.0196362250
## 135          Palestinian Territory                             0.08307358                                0.0067452424
## 132                           Oman                             0.08234870                                0.0038574381
## 18                          Belize                             0.07897048                                0.0153488414
## 104                      Macedonia                             0.07830816                                0.0105815844
## 195                      Venezuela                             0.07521959                                0.0139290635
## 37                        Colombia                             0.07274340                                0.0121537269
## 32                      Cape Verde                             0.07061879                               -0.0134023448
## 70                         Grenada                             0.06953654                                0.0059063264
## 149 Saint Vincent &amp; the Grenadines                             0.06953654                                0.0066810560
## 189           United Arab Emirates                             0.06709441                                0.0038283764
## 128                      Nicaragua                             0.06706664                                0.0028889022
## 44                            Cuba                             0.06423039                                          NA
## 148                    Saint Lucia                             0.05890447                                0.0004898546
## 86                         Jamaica                             0.04627311                               -0.0125897127
## 136                         Panama                             0.04072825                               -0.0165229796
## 41                      Costa Rica                             0.03375404                               -0.0235889415</code></pre>
</div>
<div id="g-h-classification" class="section level5">
<h5>G &gt; H classification</h5>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">Performance</span>(<span class="at">category =</span> <span class="st">&quot;G&gt;H&quot;</span>, <span class="at">year =</span> <span class="dv">1995</span>, <span class="at">vars =</span> <span class="fu">paste</span>(<span class="fu">c</span>(variables<span class="sc">$</span>health, variables<span class="sc">$</span>gender), <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>## [[1]]
##                country imr_wpp_avg_growth1995_2015 perf_imr_wpp_avg_growth1995_2015
## 11          Azerbaijan                      50.336                        12.835569
## 176         Tajikistan                      50.164                        11.059277
## 118           Mongolia                      44.720                         8.030579
## 89          Kazakhstan                      36.778                         7.819949
## 66             Georgia                      32.079                         3.056770
## 80           Indonesia                      30.908                        -1.615599
## 122            Myanmar                      29.016                       -11.546268
## 185       Turkmenistan                      28.561                        -6.658295
## 91            Kiribati                      18.297                               NA
## 116            Moldova                      14.813                        -7.908269
## 145 Russian Federation                      13.594                        -1.880306
## 140        Philippines                      12.746                       -13.302788
## 96              Latvia                      12.398                        -0.104913
## 123            Namibia                      11.218                       -18.900003
## 150              Samoa                       8.074                               NA
## 23            Botswana                       6.349                       -20.199963
## 182  Trinidad &amp; Tobago                       2.346                       -17.531881
## 98             Lesotho                      -2.540                       -39.462373
## 
## [[2]]
##                country life_exp_wpp_avg_growth1995_2015 perf_life_exp_wpp_avg_growth1995_2015
## 176         Tajikistan                            11.59                             3.8993025
## 23            Botswana                             7.93                            -1.0793482
## 118           Mongolia                             7.70                             1.5072228
## 122            Myanmar                             7.03                             0.7722154
## 11          Azerbaijan                             7.02                             1.3393825
## 80           Indonesia                             6.70                             0.8886969
## 96              Latvia                             6.47                             1.1334483
## 91            Kiribati                             5.85                                    NA
## 150              Samoa                             5.49                                    NA
## 185       Turkmenistan                             4.60                            -2.1663897
## 182  Trinidad &amp; Tobago                             4.10                            -0.9659845
## 145 Russian Federation                             3.69                            -2.1679214
## 116            Moldova                             3.67                            -0.7192621
## 89          Kazakhstan                             3.62                            -2.3124749
## 140        Philippines                             2.72                            -1.6554977
## 66             Georgia                             2.20                            -1.4107937
## 123            Namibia                            -0.80                            -7.6352043
## 98             Lesotho                           -10.43                           -16.9123993
## 
## [[3]]
##                country asfr_adol_wpp_avg_growth1995_2015 perf_asfr_adol_wpp_avg_growth1995_2015
## 23            Botswana                            46.999                             15.4289943
## 116            Moldova                            37.411                             14.2702651
## 96              Latvia                            28.216                              7.2037530
## 145 Russian Federation                            25.402                              1.2293005
## 91            Kiribati                            24.806                                     NA
## 89          Kazakhstan                            22.423                             -1.2837373
## 182  Trinidad &amp; Tobago                            21.265                             -3.4595612
## 66             Georgia                            17.273                             -7.6308664
## 123            Namibia                            12.704                            -17.0683115
## 80           Indonesia                            12.635                            -10.6601039
## 122            Myanmar                            12.529                              0.6469443
## 118           Mongolia                            11.837                             -2.2280242
## 176         Tajikistan                             6.931                            -14.3965776
## 150              Samoa                             5.418                                     NA
## 185       Turkmenistan                            -0.034                            -12.6301260
## 98             Lesotho                            -1.130                            -25.9133608
## 140        Philippines                            -6.293                            -26.3880743
## 11          Azerbaijan                           -11.708                            -28.1711113
## 
## [[4]]
##                country mys_age_ratio_ihme_avg_growth1995_2015 perf_mys_age_ratio_ihme_avg_growth1995_2015
## 80           Indonesia                             0.13216546                                 0.057820163
## 122            Myanmar                             0.08593496                                 0.010158212
## 91            Kiribati                             0.08095850                                          NA
## 118           Mongolia                             0.07828564                                 0.012338947
## 123            Namibia                             0.07785957                                 0.013419478
## 11          Azerbaijan                             0.07350375                                 0.007471023
## 176         Tajikistan                             0.07136763                                 0.001041446
## 185       Turkmenistan                             0.06560281                                 0.001976711
## 140        Philippines                             0.06271854                                 0.000721767
## 23            Botswana                             0.06064364                                 0.001511050
## 182  Trinidad &amp; Tobago                             0.05466513                                -0.004313740
## 150              Samoa                             0.05448187                                          NA
## 89          Kazakhstan                             0.05076656                                -0.009155515
## 96              Latvia                             0.04703462                                -0.010155664
## 66             Georgia                             0.04437297                                -0.017572110
## 145 Russian Federation                             0.04059728                                -0.016813672
## 116            Moldova                             0.04052356                                -0.021356648
## 98             Lesotho                             0.02658713                                -0.026027000</code></pre>
</div>
<div id="high-classification" class="section level5">
<h5>High classification</h5>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">Performance</span>(<span class="at">category =</span> <span class="st">&quot;upp&quot;</span>, <span class="at">year =</span> <span class="dv">1995</span>, <span class="at">vars =</span> <span class="fu">paste</span>(<span class="fu">c</span>(variables<span class="sc">$</span>health, variables<span class="sc">$</span>gender), <span class="st">&quot;avg&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>## [[1]]
##                      country imr_wpp_avg_growth1995_2015 perf_imr_wpp_avg_growth1995_2015
## 2                    Albania                      21.524                       -2.6455598
## 97                   Lebanon                      15.523                       -4.5464724
## 144                  Romania                      14.624                       -3.0035233
## 6          Antigua &amp; Barbuda                      13.822                       -0.4857881
## 58                   Estonia                      13.135                        1.4932876
## 102                Lithuania                      12.110                        0.3161925
## 141                   Poland                      11.950                        0.1964129
## 16                   Belarus                      11.669                        1.3758105
## 22      Bosnia &amp; Herzegovina                      11.508                       -6.6625136
## 169                Sri Lanka                      11.212                       -6.0751336
## 7                  Argentina                      11.173                       -5.9031548
## 192                  Uruguay                      10.003                       -4.4020445
## 12                   Bahamas                       9.455                       -0.7449696
## 188                  Ukraine                       8.298                       -4.4452618
## 77                   Hungary                       8.214                        0.5219485
## 13                   Bahrain                       7.950                       -0.8484653
## 143                    Qatar                       7.924                       -0.3856666
## 165              South Korea                       7.328                        4.1094145
## 26                  Bulgaria                       7.080                       -3.5939282
## 35                     Chile                       6.799                       -2.5093119
## 46            Czech Republic                       6.457                        5.6966334
## 142                 Portugal                       6.177                        4.8007260
## 160                 Slovakia                       6.157                        0.6657338
## 43                   Croatia                       5.953                        1.3036162
## 107                 Malaysia                       5.922                       -1.3087953
## 69                    Greece                       5.166                        5.1617569
## 161                 Slovenia                       5.119                        7.2096513
## 93                    Kuwait                       5.108                       -0.3080558
## 84                    Israel                       5.057                        5.8439772
## 45                    Cyprus                       4.989                        3.4680529
## 85                     Italy                       4.390                        7.3542961
## 17                   Belgium                       4.302                        6.5798479
## 103               Luxembourg                       3.835                        8.6538399
## 168                    Spain                       3.750                        7.5706528
## 10                   Austria                       3.546                        7.7647028
## 78                   Iceland                       3.197                       13.1494990
## 83                   Ireland                       3.191                        7.2779049
## 131                   Norway                       3.067                       10.6426297
## 63                    France                       3.053                        7.8559904
## 110                    Malta                       3.011                        2.4997578
## 127              New Zealand                       2.992                        5.5758356
## 9                  Australia                       2.884                        7.9580453
## 62                   Finland                       2.836                       11.5443653
## 159                Singapore                       2.747                       11.9578019
## 48                   Denmark                       2.742                        8.3188468
## 126              Netherlands                       2.716                        8.5787807
## 191 United States of America                       2.715                        4.1841911
## 172                   Sweden                       2.706                       11.3767824
## 67                   Germany                       2.631                        8.9965603
## 190           United Kingdom                       2.625                        6.8465007
## 181                    Tonga                       2.538                               NA
## 87                     Japan                       2.216                       13.3440467
## 173              Switzerland                       2.169                        9.1123966
## 15                  Barbados                       1.973                       -5.3779101
## 25                    Brunei                       1.764                        0.8840916
## 31                    Canada                       1.594                        7.5128014
## 175                   Taiwan                       1.160                        8.6012138
## 157               Seychelles                       0.897                       -5.9754565
## 
## [[2]]
##                      country life_exp_wpp_avg_growth1995_2015 perf_life_exp_wpp_avg_growth1995_2015
## 165              South Korea                             8.43                           4.247046363
## 58                   Estonia                             8.28                           3.302527221
## 97                   Lebanon                             7.54                           4.183376951
## 161                 Slovenia                             6.40                           2.407613840
## 22      Bosnia &amp; Herzegovina                             6.39                           3.854974686
## 141                   Poland                             6.00                           1.920639344
## 169                Sri Lanka                             5.87                           2.442315741
## 77                   Hungary                             5.84                           0.881229560
## 2                    Albania                             5.80                           3.055084910
## 142                 Portugal                             5.72                           2.157139099
## 46            Czech Republic                             5.67                           1.219317205
## 159                Singapore                             5.61                           2.204265875
## 103               Luxembourg                             5.37                           0.965812154
## 144                  Romania                             5.33                           1.056515761
## 83                   Ireland                             5.26                           1.620536992
## 35                     Chile                             5.07                           1.897607618
## 127              New Zealand                             4.97                           1.550965508
## 48                   Denmark                             4.91                           0.946418969
## 85                     Italy                             4.89                           1.584648774
## 168                    Spain                             4.88                           1.970182808
## 62                   Finland                             4.86                           1.254713235
## 175                   Taiwan                             4.84                           0.778877115
## 10                   Austria                             4.84                           1.113901672
## 173              Switzerland                             4.76                           1.219418343
## 84                    Israel                             4.71                           1.394133040
## 9                  Australia                             4.67                           1.379996256
## 43                   Croatia                             4.64                           1.078231248
## 160                 Slovakia                             4.63                           0.266860418
## 190           United Kingdom                             4.63                           1.103342735
## 63                    France                             4.60                           1.285720684
## 67                   Germany                             4.46                           0.660418168
## 131                   Norway                             4.32                           0.920293592
## 102                Lithuania                             4.26                          -0.301898393
## 25                    Brunei                             4.17                          -1.727649274
## 17                   Belgium                             4.12                           0.514950553
## 126              Netherlands                             4.05                           0.642320500
## 31                    Canada                             4.04                           0.684358924
## 6          Antigua &amp; Barbuda                             4.03                          -0.133562873
## 192                  Uruguay                             4.02                           0.349588820
## 87                     Japan                             3.90                           1.050995400
## 110                    Malta                             3.85                           1.161054574
## 172                   Sweden                             3.75                           0.626249548
## 69                    Greece                             3.70                           0.782597130
## 78                   Iceland                             3.66                           0.540370295
## 13                   Bahrain                             3.52                          -0.629546757
## 7                  Argentina                             3.51                          -0.247213996
## 107                 Malaysia                             3.49                          -0.601022045
## 15                  Barbados                             3.43                          -0.000364014
## 191 United States of America                             3.29                          -0.891333474
## 143                    Qatar                             3.14                          -0.327268312
## 26                  Bulgaria                             3.13                          -1.029728466
## 16                   Belarus                             3.00                          -1.726528327
## 45                    Cyprus                             2.98                           0.039938412
## 93                    Kuwait                             2.37                          -2.580321852
## 157               Seychelles                             2.33                          -2.576258472
## 188                  Ukraine                             2.19                          -2.525136845
## 12                   Bahamas                             1.50                          -3.673366250
## 181                    Tonga                             1.13                                    NA
## 
## [[3]]
##                      country asfr_adol_wpp_avg_growth1995_2015 perf_asfr_adol_wpp_avg_growth1995_2015
## 12                   Bahamas                            36.846                              5.7790401
## 143                    Qatar                            32.737                              8.8170197
## 191 United States of America                            31.574                              1.4375095
## 102                Lithuania                            31.449                             10.2936183
## 58                   Estonia                            30.958                              9.0448706
## 46            Czech Republic                            30.337                              8.0270440
## 188                  Ukraine                            29.747                              5.3749742
## 97                   Lebanon                            28.063                              9.5385551
## 6          Antigua &amp; Barbuda                            24.791                             -4.5983509
## 25                    Brunei                            23.832                             -0.4438191
## 26                  Bulgaria                            22.958                             -4.3004540
## 160                 Slovakia                            22.897                              0.2896576
## 16                   Belarus                            22.863                              1.6807380
## 45                    Cyprus                            19.171                              5.3253625
## 77                   Hungary                            16.222                             -2.7980072
## 78                   Iceland                            16.141                             -0.4988089
## 15                  Barbados                            15.198                            -11.6033526
## 141                   Poland                            15.030                              0.3635612
## 161                 Slovenia                            14.792                              3.9358370
## 35                     Chile                            14.682                            -12.8693229
## 31                    Canada                            13.647                             -2.8188139
## 22      Bosnia &amp; Herzegovina                            13.529                              7.0475840
## 93                    Kuwait                            13.239                             -1.7589648
## 175                   Taiwan                            12.958                              3.2845002
## 190           United Kingdom                            12.034                             -6.4696724
## 10                   Austria                            11.925                             -1.0727136
## 144                  Romania                            10.674                            -10.1827562
## 127              New Zealand                            10.469                             -9.1489326
## 142                 Portugal                            10.431                             -1.8577893
## 7                  Argentina                             9.988                            -18.4883586
## 192                  Uruguay                             9.948                            -18.5058787
## 131                   Norway                             9.709                              0.5793606
## 43                   Croatia                             9.495                              0.1199615
## 69                    Greece                             8.808                             -0.2855407
## 9                  Australia                             8.573                             -4.8209601
## 13                   Bahrain                             8.318                             -4.2133092
## 181                    Tonga                             7.922                                     NA
## 67                   Germany                             7.845                             -1.4915662
## 84                    Israel                             7.799                             -4.0668726
## 169                Sri Lanka                             7.446                             -3.8784869
## 157               Seychelles                             6.788                            -22.8289560
## 103               Luxembourg                             6.118                             -1.3890802
## 172                   Sweden                             5.957                              1.8057716
## 107                 Malaysia                             5.943                             -2.6075384
## 83                   Ireland                             5.399                             -3.0556966
## 17                   Belgium                             4.790                              1.4918021
## 48                   Denmark                             4.465                              4.0644666
## 159                Singapore                             3.980                              5.8127476
## 62                   Finland                             3.957                              0.4361362
## 173              Switzerland                             3.044                              6.0676348
## 126              Netherlands                             2.663                              5.5100660
## 165              South Korea                             2.345                             15.2285949
## 85                     Italy                             1.849                              3.5494294
## 63                    France                             1.390                              2.6212417
## 168                    Spain                             0.707                              0.1890738
## 87                     Japan                            -0.730                             11.5639760
## 110                    Malta                            -1.293                             -4.2897158
## 2                    Albania                            -1.997                             -6.0831084
## 
## [[4]]
##                      country mys_age_ratio_ihme_avg_growth1995_2015 perf_mys_age_ratio_ihme_avg_growth1995_2015
## 107                 Malaysia                             0.11119116                                0.0415546957
## 159                Singapore                             0.10729032                                0.0418798528
## 13                   Bahrain                             0.10442908                                0.0369915721
## 165              South Korea                             0.09404469                                0.0278640667
## 175                   Taiwan                             0.08167897                                0.0180615382
## 142                 Portugal                             0.08070374                                0.0210084735
## 22      Bosnia &amp; Herzegovina                             0.07890490                                0.0065169741
## 43                   Croatia                             0.07685400                                0.0130836578
## 2                    Albania                             0.07504279                                0.0069208481
## 25                    Brunei                             0.07393589                                0.0144599481
## 69                    Greece                             0.07252133                                0.0116053474
## 10                   Austria                             0.07058824                                0.0120222252
## 169                Sri Lanka                             0.07056372                                0.0047083165
## 15                  Barbados                             0.06953654                                0.0097867757
## 160                 Slovakia                             0.06886680                                0.0078547721
## 173              Switzerland                             0.06777948                                0.0099571535
## 45                    Cyprus                             0.06675646                                0.0059653963
## 143                    Qatar                             0.06587078                                0.0088989120
## 110                    Malta                             0.06565837                                0.0061237864
## 97                   Lebanon                             0.06559423                               -0.0005560431
## 168                    Spain                             0.06468964                                0.0063613532
## 181                    Tonga                             0.06360591                                          NA
## 103               Luxembourg                             0.06316937                                0.0070168011
## 161                 Slovenia                             0.06248677                                0.0033870523
## 46            Czech Republic                             0.05631772                               -0.0020779953
## 67                   Germany                             0.05606827                               -0.0012563411
## 144                  Romania                             0.05531035                               -0.0084798843
## 93                    Kuwait                             0.05522287                               -0.0067141274
## 157               Seychelles                             0.05520697                               -0.0022081858
## 78                   Iceland                             0.05423449                               -0.0019480468
## 85                     Italy                             0.05037057                               -0.0068499127
## 7                  Argentina                             0.05009583                               -0.0073897300
## 126              Netherlands                             0.04794355                               -0.0087358349
## 35                     Chile                             0.04739158                               -0.0112764303
## 188                  Ukraine                             0.04625020                               -0.0134293044
## 12                   Bahamas                             0.04566521                               -0.0082120422
## 26                  Bulgaria                             0.04511839                               -0.0132590110
## 84                    Israel                             0.04439595                               -0.0112275655
## 63                    France                             0.04427825                               -0.0104629869
## 102                Lithuania                             0.04383030                               -0.0148477416
## 190           United Kingdom                             0.04373053                               -0.0120791890
## 131                   Norway                             0.04366683                               -0.0112157774
## 87                     Japan                             0.04261866                               -0.0128137747
## 77                   Hungary                             0.04205984                               -0.0162642732
## 141                   Poland                             0.04185723                               -0.0171248076
## 48                   Denmark                             0.03980209                               -0.0151929663
## 192                  Uruguay                             0.03840198                               -0.0167217115
## 172                   Sweden                             0.03660345                               -0.0170013979
## 17                   Belgium                             0.03520596                               -0.0198282868
## 9                  Australia                             0.03502774                               -0.0197365965
## 62                   Finland                             0.03445790                               -0.0198204819
## 127              New Zealand                             0.03397190                               -0.0211042310
## 16                   Belarus                             0.03183584                               -0.0257884838
## 83                   Ireland                             0.03163315                               -0.0225772338
## 58                   Estonia                             0.03030413                               -0.0256579284
## 191 United States of America                             0.02212165                               -0.0311109471
## 6          Antigua &amp; Barbuda                             0.02105694                               -0.0318324873
## 31                    Canada                             0.01848898                               -0.0348837654</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">save</span>(data, codebook, categories, variables, df, new, <span class="at">file =</span> <span class="st">&quot;_data/LSCMWG_working_class.RData&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>

<script type="text/javascript" src="links.js"></script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
